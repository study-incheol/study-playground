# 1.9. Annotation-based Container Configuration

> [1.9. Annotation-based Container Configuration](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-annotation-config) μ±•ν„°λ¥Ό μ”μ•½ν• λ‚΄μ©μ…λ‹λ‹¤.

{% hint style="success" %}

#### π’΅ XMLλ³΄λ‹¤ μ–΄λ…Έν…μ΄μ…μΌλ΅ Springμ„ κµ¬μ„±ν•λ” κ²ƒμ΄ λ” μΆ‹μ„κΉ?

κ²°λ΅ μ€ κ° μ ‘κ·Ό λ°©μ‹λ§λ‹¤ μ¥λ‹¨μ μ΄ μμΌλ©°, μΌλ°μ μΌλ΅ μ–΄λ–¤ μ „λµμ΄ λ” μ ν•©ν•μ§€ κ²°μ •ν•λ” κ²ƒμ€ κ°λ°μλ‹¤. μ–΄λ…Έν…μ΄μ…μ€ μ •μλλ” λ°©μ‹μΌλ΅ μΈν•΄ μ„ μ–Έμ— λ§μ€ μ»¨ν…μ¤νΈλ¥Ό μ κ³µν•μ—¬ λ” μ§§κ³  κ°„κ²°ν• κµ¬μ„±μΌλ΅ μ΄μ–΄μ§„λ‹¤. κ·Έλ¬λ‚ XMLμ€ μ†μ¤ μ½”λ“λ¥Ό κ±΄λ“λ¦¬μ§€ μ•κ±°λ‚ λ‹¤μ‹ μ»΄νμΌν•μ§€ μ•κ³ λ„ κµ¬μ„± μ”μ†λ¥Ό μ—°κ²°ν•λ” λ° νƒμ›”ν•λ‹¤. μΌλ¶€ κ°λ°μλ” μ†μ¤μ— κ°€κΉμ΄ λ°°μΉλ¥Ό μ„ νΈν•μ§€λ§ μ–΄λ–¤ κ°λ°μλ” μ–΄λ…Έν…μ΄μ…μ΄ λ‹¬λ¦° ν΄λμ¤κ°€ λ” μ΄μƒ POJOκ°€ μ•„λ‹λ©° κµ¬μ„±μ΄ λ¶„μ‚°λμ–΄ μ μ–΄ν•κΈ°κ°€ λ” μ–΄λ µλ‹¤κ³  μ£Όμ¥ν•κΈ°λ„ ν•λ‹¤.

μ–΄λ–¤ μ„ νƒμ„ ν•λ“ , μ¤ν”„λ§μ€ λ‘ κ°€μ§€ μ¤νƒ€μΌμ„ λ¨λ‘ μμ©ν•κ³  μ‹¬μ§€μ–΄ κ·Έκ²ƒλ“¤μ„ ν•¨κ» μ„μ„ μλ„ μλ‹¤. [JavaConfig](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-java) μµμ…μ„ ν†µν•΄ Springμ€ λ€μƒ κµ¬μ„± μ”μ†μ μ†μ¤ μ½”λ“λ¥Ό κ±΄λ“λ¦¬μ§€ μ•κ³  μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•  μ μλ‹¤.

{% endhint %}

XML μ„¤μ •μ λ€μ•μ€ μ–΄λ…Έν…μ΄μ… κΈ°λ° κµ¬μ„±μ— μν•΄ μ κ³µλλ©°, μ΄λ” κΊΎμ‡  λ€κ΄„νΈ μ„ μ–Έ λ€μ‹  κµ¬μ„± μ”μ†λ¥Ό μ—°κ²°ν•κΈ° μ„ν•΄ λ°”μ΄νΈ μ½”λ“ λ©”νƒ€λ°μ΄ν„°μ— μμ΅΄ν•λ‹¤. XMLμ„ μ‚¬μ©ν•μ—¬ λΉ μμ΅΄μ„±μ„ μ„¤λ…ν•λ” λ€μ‹  κ°λ°μλ” κ΄€λ ¨ ν΄λμ¤, λ©”μ„λ“ λλ” ν•„λ“ μ„ μ–Έμ— λ€ν• μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ μ½¤ν¬λ„νΈ ν΄λμ¤λ΅ κµ¬μ„±μ„ μ΄λ™ν•λ‹¤. μλ¥Ό λ“¤μ–΄ Spring 2.0μ—μ„λ” [`@Required`](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-required-annotation) μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ ν•„μ μ†μ„±μ„ μ μ©ν•  μ μλ‹¤. μ¤ν”„λ§ 2.5λ” μ¤ν”„λ§μ μμ΅΄μ„± μ£Όμ…μ„ κµ¬λ™ν•κΈ° μ„ν•΄ λ™μΌν• μΌλ°μ μΈ μ ‘κ·Ό λ°©μ‹μ„ λ”°λ¥΄λ” κ²ƒμ„ κ°€λ¥ν•κ² ν–λ‹¤. κΈ°λ³Έμ μΌλ΅ `@Autowired` μ–΄λ…Έν…μ΄μ…μ€ [Autowiring Collaborator](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-autowire) μ—μ„ μ„¤λ…ν• κ²ƒκ³Ό λ™μΌν• κΈ°λ¥μ„ μ κ³µν•μ§€λ§ λ³΄λ‹¤ μ„Έλ°€ν• μ μ–΄ κΈ°λ¥κ³Ό λ³΄λ‹¤ κ΄‘λ²”μ„ν• μ μ© κ°€λ¥μ„±μ„ μ κ³µν•λ‹¤. μ¤ν”„λ§ 2.5λ” λν• `@PostConstruct` λ° `@PreDestroy`μ™€ κ°™μ€ μ–΄λ…Έν…μ΄μ…μ μ§€μ›μ„ μ¶”κ°€ν•μ€λ‹¤. μ¤ν”„λ§ 3.0μ€ `javax.inject` ν¨ν‚¤μ§€μ— ν¬ν•¨λ μ–΄λ…Έν…μ΄μ…(μ: `@Inject`, `@Named`)μ— λ€ν• μ§€μ›μ„ μ¶”κ°€ν•μ€λ‹¤. μ΄λ¬ν• μ–΄λ…Έν…μ΄μ…μ— λ€ν• μμ„Έν• λ‚΄μ©μ€ [κ΄€λ ¨ μ„Ήμ…](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-standard-annotations) μ—μ„ ν™•μΈν•  μ μλ‹¤.

> π’΅ XML μ£Όμ… μ „μ— μ–΄λ…Έν…μ΄μ… μ£Όμ…μ΄ μν–‰λλ‹¤. λ”°λΌμ„ XML κµ¬μ„±μ€ λ‘ κ°€μ§€ μ ‘κ·Ό λ°©μ‹μ„ ν†µν•΄ μ—°κ²°λ μ†μ„±μ— λ€ν• μ–΄λ…Έν…μ΄μ…μ„ μ¬μ •μν•λ‹¤.

ν•­μƒ κ·Έλ ‡λ“―μ΄ post-processorsλ¥Ό κ°λ³„ λΉ μ •μλ΅ λ“±λ΅ν•  μ μμ§€λ§ XML κΈ°λ° μ¤ν”„λ§ κµ¬μ„±μ— λ‹¤μ νƒκ·Έλ¥Ό ν¬ν•¨ν•¨μΌλ΅μ¨ μ•”μ‹μ μΌλ΅ λ“±λ΅ν•  μλ„ μλ‹¤(`context` λ„¤μ„μ¤νμ΄μ¤ ν¬ν•¨).

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context
        https://www.springframework.org/schema/context/spring-context.xsd">

    <context:annotation-config/>

</beans>
```

`<context:annotation-config/>` μ”μ†λ” λ‹¤μ post-processorsλ¥Ό μ•”λ¬µμ μΌλ΅ λ“±λ΅ν•λ‹¤.

- [ConfigurationClassPostProcessor](https://docs.spring.io/spring-framework/docs/5.3.21/javadoc-api/org/springframework/context/annotation/ConfigurationClassPostProcessor.html)

- [AutowiredAnnotationBeanPostProcessor](https://docs.spring.io/spring-framework/docs/5.3.21/javadoc-api/org/springframework/beans/factory/annotation/AutowiredAnnotationBeanPostProcessor.html)

- [CommonAnnotationBeanPostProcessor](https://docs.spring.io/spring-framework/docs/5.3.21/javadoc-api/org/springframework/context/annotation/CommonAnnotationBeanPostProcessor.html)

- [PersistenceAnnotationBeanPostProcessor](https://docs.spring.io/spring-framework/docs/5.3.21/javadoc-api/org/springframework/orm/jpa/support/PersistenceAnnotationBeanPostProcessor.html)

- [EventListenerMethodProcessor](https://docs.spring.io/spring-framework/docs/5.3.21/javadoc-api/org/springframework/context/event/EventListenerMethodProcessor.html)

`<context:annotation-config/>` λ” μ •μλ κ²ƒκ³Ό λ™μΌν• μ‘μ© ν”„λ΅κ·Έλ¨ μ»¨ν…μ¤νΈμ—μ„ λΉμ— λ€ν• μ–΄λ…Έν…μ΄μ…λ§ μ°Ύλ”λ‹¤. μ¦‰, `DispatcherServlet`μ `WebApplicationContext`μ— `<context:annotation-config/>`λ¥Ό λ„£μΌλ©΄ μ„λΉ„μ¤κ°€ μ•„λ‹ μ»¨νΈλ΅¤λ¬μ—μ„ @Autowired λΉλ§ ν™•μΈν•λ‹¤. μμ„Έν• λ‚΄μ©μ€ [λ””μ¤ν¨μ² μ„λΈ”λ¦Ώ](https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#mvc-servlet) μ„ μ°Έμ΅°ν•μ‹­μ‹μ¤.

## 1.9.1. @Required

`@Required` μ–΄λ…Έν…μ΄μ…μ€ λ‹¤μ μμ μ™€ κ°™μ΄ μ†μ„± setter λ©”μ„λ“μ— μ μ©λλ‹¤.

``` java
public class SimpleMovieLister {

    private MovieFinder movieFinder;

    @Required
    public void setMovieFinder(MovieFinder movieFinder) {
        this.movieFinder = movieFinder;
    }

    // ...
}
```

μ΄ μ–΄λ…Έν…μ΄μ…μ€ κµ¬μ„± μ‹, λΉ μ •μμ λ…μ‹μ  μ†μ„± κ°’ λλ” autowiringμ„ ν†µν•΄ μν–¥μ„ λ°›λ” λΉ μ†μ„±μ„ μ±„μ›μ•Ό ν•¨μ„ λ‚νƒ€λ‚Έλ‹¤. μν–¥μ„ λ°›λ” λΉ μ†μ„±μ΄ μ±„μ›μ§€μ§€ μ•μ€ κ²½μ° μ»¨ν…μ΄λ„λ” μμ™Έλ¥Ό λ°μƒμ‹ν‚¨λ‹¤. μ΄λ¥Ό ν†µν•΄ `NullPointerException`λ¥Ό λ°©μ§€ν•κ³  μ‹ μ†ν•κ³  λ…μ‹μ μΈ μ¤λ¥λ¥Ό λ°μƒμ‹ν‚¬ μ μλ‹¤. λΉ ν΄λμ¤ μμ²΄μ— μ–΄μ„¤μ…μ„ λ„£λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤(μ: init λ©”μ„λ“). μ΄λ ‡κ² ν•λ©΄ μ»¨ν…μ΄λ„ μ™Έλ¶€μ—μ„ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” κ²½μ°μ—λ„ ν•„μ”ν• μ°Έμ΅° λ° κ°’μ΄ μ μ©λλ‹¤.

> π’΅ `@Required` μ–΄λ…Έν…μ΄μ…μ„ μ§€μ›ν•λ ¤λ©΄ [`RequiredAnnotationBeanPostProcessor`](https://docs.spring.io/spring-framework/docs/5.3.21/javadoc-api/org/springframework/beans/factory/annotation/RequiredAnnotationBeanPostProcessor.html) λ¥Ό λΉμΌλ΅ λ“±λ΅ν•΄μ•Ό ν•λ‹¤.

{% hint style="success" %}

`@Required` μ–΄λ…Έν…μ΄μ…κ³Ό `RequiredAnnotationBeanPostProcessor`λ” μ¤ν”„λ§ ν”„λ μ„μ›ν¬ 5.1λ¶€ν„° κ³µμ‹μ μΌλ΅ μ‚¬μ©λμ§€ μ•λ”λ‹¤. λ€μ‹  `@PostConstruct`μ™€ κ°™μ€ μ–΄λ…Έν…μ΄μ…μ„ setter λ©”μ„λ“μ™€ ν•¨κ» μ“Έ μ μλ‹¤.

{% endhint %}

## 1.9.2. Using `@Autowired`

λ‹¤μ μμ μ™€ κ°™μ΄ `@Autowired` μ–΄λ…Έν…μ΄μ…μ„ μƒμ„±μμ— μ μ©ν•  μ μλ‹¤.

```java
public class MovieRecommender {

    private final CustomerPreferenceDao customerPreferenceDao;

    @Autowired
    public MovieRecommender(CustomerPreferenceDao customerPreferenceDao) {
        this.customerPreferenceDao = customerPreferenceDao;
    }

    // ...
}
```

λ‹¤μ μμ μ™€ κ°™μ΄ μΌλ° λ©”μ„λ“μ— μ–΄λ…Έν…μ΄μ…μ„ μ μ©ν•  μλ„ μλ‹¤.

```java
public class MovieRecommender {

    private MovieCatalog movieCatalog;

    private CustomerPreferenceDao customerPreferenceDao;

    @Autowired
    public void prepare(MovieCatalog movieCatalog,
                        CustomerPreferenceDao customerPreferenceDao) {
        this.movieCatalog = movieCatalog;
        this.customerPreferenceDao = customerPreferenceDao;
    }

    // ...
}
```

λ‹¤μ μμ μ™€ κ°™μ΄ `@Autowired`λ¥Ό ν•„λ“μ— μ μ©ν•  μλ„ μκ³  μƒμ„±μμ™€ νΌν•©ν•μ—¬ μ‚¬μ©ν•  μλ„ μλ‹¤.

```java
public class MovieRecommender {

    private final CustomerPreferenceDao customerPreferenceDao;

    @Autowired
    private MovieCatalog movieCatalog;

    @Autowired
    public MovieRecommender(CustomerPreferenceDao customerPreferenceDao) {
        this.customerPreferenceDao = customerPreferenceDao;
    }

    // ...
}
```

λ‹¤μ μμ μ™€ κ°™μ΄ νΉμ • μ ν•μ λ°°μ—΄μ„ μμƒν•λ” ν•„λ“ λλ” λ©”μ„λ“μ— `@Autowired` μ£Όμ„μ„ μ¶”κ°€ν•μ—¬ `ApplicationContext`μ—μ„ νΉμ • μ ν•μ λ¨λ“  λΉμ„ μ κ³µν•λ„λ΅ Springμ— μ§€μ‹ν•  μλ„ μλ‹¤.

```java
public class MovieRecommender {

    @Autowired
    private MovieCatalog[] movieCatalogs;

    // ...
}
```

λ‹¤μ μμ μ™€ κ°™μ΄ μ»¬λ ‰μ…μ—λ„ λ™μΌν•κ² μ μ©λλ‹¤.

```java
public class MovieRecommender {

    private Set<MovieCatalog> movieCatalogs;

    @Autowired
    public void setMovieCatalogs(Set<MovieCatalog> movieCatalogs) {
        this.movieCatalogs = movieCatalogs;
    }

    // ...
}
```

λΉμ€ `org.spring framework.core.Ordered` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•κ±°λ‚ `@Order` λλ” `@Priority` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ νΉμ • μμ„λ€λ΅ λ°°μ—΄ λλ” λ¦¬μ¤νΈλ¥Ό μ •λ ¬ν•  μ μλ‹¤. κ·Έλ ‡μ§€ μ•μΌλ©΄ μμ„λ” μ»¨ν…μ΄λ„μ—μ„ λΉ μ •μμ λ“±λ΅ μμ„λ¥Ό λ”°λ¥Έλ‹¤.

`Map` μΈμ¤ν„΄μ¤λ„ ν‚¤ μ ν•μ΄ `String`μ΄λ©΄ `@Autowired`λ΅ μ—°κ²°ν•  μ μλ‹¤. λ§µ κ°’μ—λ” ν•„μ”ν• νƒ€μ…μ λ¨λ“  λΉμ΄ ν¬ν•¨λλ©° ν‚¤μ—λ” λΉ μ΄λ¦„μ΄ ν¬ν•¨λλ‹¤.

```java
public class MovieRecommender {

    private Map<String, MovieCatalog> movieCatalogs;

    @Autowired
    public void setMovieCatalogs(Map<String, MovieCatalog> movieCatalogs) {
        this.movieCatalogs = movieCatalogs;
    }

    // ...
}
```

μ§€μ •λ μ£Όμ… μ‹μ μ— λ€ν•΄ μ‚¬μ©ν•  μ μλ” μΌμΉν•λ” ν›„λ³΄ λΉμ΄ μ—†μΌλ©΄ κΈ°λ³Έμ μΌλ΅ autowiringμ΄ μ‹¤ν¨ν•λ‹¤. μ„ μ–Έλ λ°°μ—΄, μ»¬λ ‰μ… λλ” λ§µμ κ²½μ° ν•λ‚ μ΄μƒμ μΌμΉ μ”μ†κ°€ ν•„μ”ν•λ‹¤.

κΈ°λ³Έ λ™μ‘μ€ μ–΄λ…Έν…μ΄μ…μ΄ λ‹¬λ¦° λ©”μ„λ“μ™€ ν•„λ“λ¥Ό ν•„μ”ν• μμ΅΄μ„±μΌλ΅ λ‚νƒ€λ‚΄λ” κ²ƒμ΄λ‹¤. λ‹¤μ μμ μ™€ κ°™μ΄ μ΄ λ™μ‘μ„ λ³€κ²½ν•  μ μλ‹¤. `@Autowired`μ `required` μ†μ„±μ„ falseλ΅ μ„¤μ •ν•μ—¬ ν”„λ μ„μ›ν¬κ°€ λ¶λ§μ΅±μ¤λ¬μ΄ μ£Όμ… μ‹μ μ„ κ±΄λ„λ›Έ μ μλ‹¤.

```java
public class SimpleMovieLister {

    private MovieFinder movieFinder;

    @Autowired(required = false)
    public void setMovieFinder(MovieFinder movieFinder) {
        this.movieFinder = movieFinder;
    }

    // ...
}
```

non-required λ©”μ„λ“λ” μμ΅΄μ„±(λλ” μ—¬λ¬ μΈμμ κ²½μ° μμ΅΄μ„± μ¤‘ ν•λ‚)μ„ μ‚¬μ©ν•  μ μ—†λ” κ²½μ° νΈμ¶λμ§€ μ•λ”λ‹¤. μ΄ κ²½μ° non-required ν•„λ“λ” μ±„μ›μ§€μ§€ μ•μΌλ©° κΈ°λ³Έκ°’μ€ κ·Έλ€λ΅ μ μ§€λλ‹¤.

{% hint style="success" %}

μ£Όμ–΄μ§„ λΉ ν΄λμ¤μ ν•λ‚μ μƒμ„±μλ§μ΄ ν•„μ μ†μ„±μ΄ `true`λ΅ μ„¤μ •λ `@Autowired`λ¥Ό μ„ μ–Έν•  μ μμΌλ©°, μ΄λ” Spring λΉμΌλ΅ μ‚¬μ©λ  λ• μƒμ„±μκ°€ autowire λ¨μ„ λ‚νƒ€λ‚Έλ‹¤. κ²°κ³Όμ μΌλ΅ ν•„μ μ†μ„±μ΄ κΈ°λ³Έκ°’μ΄ `true`λ΅ μ μ§€λλ©΄ μ¤μ§ ν•λ‚μ μƒμ„±μμ—λ§ `@Autowired`λ΅ μ–΄λ…Έν…μ΄μ…μ΄ λ‹¬λ¦΄ μ μλ‹¤. μ—¬λ¬ μƒμ„±μκ°€ μ–΄λ…Έν…μ΄μ…μ„ μ„ μ–Έν•λ” κ²½μ° μλ™ μ—°κ²° ν›„λ³΄λ΅ κ°„μ£ΌλκΈ° μ„ν•΄ λ¨λ‘ `required=false`λ¥Ό μ„ μ–Έν•΄μ•Ό ν•λ‹¤(XMLμ `autowire=constructor`μ™€ μ μ‚¬). Spring μ»¨ν…μ΄λ„μ—μ„ Beanμ„ μΌμΉμ‹μΌ μ¶©μ΅±ν•  μ μλ” μμ΅΄μ„±μ΄ κ°€μ¥ λ§μ€ μƒμ„±μκ°€ μ„ νƒλκ² λλ‹¤. ν›„λ³΄ μ¤‘ μ–΄λ κ²ƒλ„ λ§μ΅±ν•  μ μ—†μΌλ©΄ primary/default μƒμ„±μ(μλ” κ²½μ°)κ°€ μ‚¬μ©λλ‹¤. μ μ‚¬ν•κ², ν΄λμ¤κ°€ μ—¬λ¬ μƒμ„±μλ¥Ό μ„ μ–Έν–μ§€λ§ κ·Έ μ¤‘ μ•„λ¬΄ κ²ƒλ„ `@Autowired`λ΅ μ–΄λ…Έν…μ΄μ… μ²λ¦¬λμ§€ μ•μ€ κ²½μ° primary/default μƒμ„±μ(μλ” κ²½μ°)κ°€ μ‚¬μ©λλ‹¤. ν΄λμ¤κ°€ μ‹μ‘ν•  λ‹¨ ν•λ‚μ μƒμ„±μλ§ μ„ μ–Έν•λ©΄ μ–΄λ…Έν…μ΄μ…μ΄ μ—†λ” κ²½μ°μ—λ„ ν•­μƒ μ‚¬μ©λλ‹¤. μ–΄λ…Έν…μ΄μ…μ΄ λ‹¬λ¦° μƒμ„±μκ°€ publicμΌ ν•„μ”λ” μ—†λ‹¤.

`@Autowired`μ `required` μ†μ„±μ€ setter λ©”μ„λ“μ—μ„ λ” μ΄μƒ μ‚¬μ©λμ§€ μ•λ” `@Required` μ–΄λ…Έν…μ΄μ…λ³΄λ‹¤ κ¶μ¥λλ‹¤. `required` μ†μ„±μ„ `false`λ΅ μ„¤μ •ν•λ©΄ μ†μ„±μ΄ μλ™ μ—°κ²° λ©μ μ— ν•„μ”ν•μ§€ μ•μΌλ©° μ†μ„±μ΄ μλ™ μ—°κ²°λ  μ μ—†λ” κ²½μ° λ¬΄μ‹λλ‹¤. λ°λ©΄ `@Required`λ” μ»¨ν…μ΄λ„κ°€ μ§€μ›ν•λ” λ¨λ“  μλ‹¨μΌλ΅ μ†μ„±μ„ μ„¤μ •ν•λ„λ΅ κ°•μ ν•κ³  κ°’μ΄ μ •μλμ§€ μ•μ€ κ²½μ° μμ™Έκ°€ λ°μƒν•λ‹¤λ” μ μ—μ„ λ” κ°•λ ¥ν•λ‹¤.

{% endhint %}

λλ” Java 8μ `java.util.Optional`μ„ ν†µν•΄ νΉμ • μμ΅΄μ„±μ non-required νΉμ„±μ„ ν‘ν„ν•  μ μλ‹¤.

```java
public class SimpleMovieLister {

    @Autowired
    public void setMovieFinder(Optional<MovieFinder> movieFinder) {
        ...
    }
}
```

Spring Framework 5.0λ¶€ν„° `@Nullable` μ–΄λ…Έν…μ΄μ…(μ–΄λ μΆ…λ¥μ ν¨ν‚¤μ§€μ—μ„λ‚ λ‹¤ κ°€λ¥ μλ¥Όλ“¤μ–΄ javax.annotation.Nullable)μ„ μ‚¬μ©ν•κ±°λ‚ Kotlinμ κΈ°λ³Έ μ κ³µ null-safety μ§€μ›μ„ ν™μ©ν•  μλ„ μλ‹¤.

```java
public class SimpleMovieLister {

    @Autowired
    public void setMovieFinder(@Nullable MovieFinder movieFinder) {
        ...
    }
}
```

`BeanFactory`, `ApplicationContext`, `Environment`, `ResourceLoader`, `ApplicationEventPublisher` λ° `MessageSource`μ™€ κ°™μ΄ μ μ•λ ¤μ§„ ν•΄κ²° κ°€λ¥ν• μμ΅΄μ„±μΈ μΈν„°νμ΄μ¤μ— `@Autowired`λ¥Ό μ‚¬μ©ν•  μλ„ μλ‹¤. μ΄λ¬ν• μΈν„°νμ΄μ¤μ™€ `ConfigurableApplicationContext` λλ” `ResourcePatternResolver`μ™€ κ°™μ€ ν™•μ¥ μΈν„°νμ΄μ¤λ” νΉλ³„ν• μ„¤μ • μ—†μ΄ μλ™μΌλ΅ ν•΄κ²°λλ‹¤. λ‹¤μ μμ λ” `ApplicationContext` κ°μ²΄λ¥Ό μλ™ μ—°κ²°ν•λ‹¤

```java
public class MovieRecommender {

    @Autowired
    private ApplicationContext context;

    public MovieRecommender() {
    }

    // ...
}
```

{% hint style="success" %}

`@Autowired`, `@Inject`, `@Value` λ° `@Resource` μ–΄λ…Έν…μ΄μ…μ€ Spring `BeanPostProcessor` κµ¬ν„μ— μν•΄ μ²λ¦¬λλ‹¤. μ΄κ²ƒμ€ μμ‹ μ `BeanPostProcessor` λλ” `BeanFactoryPostProcessor` μ ν•(μλ” κ²½μ°) λ‚΄μ—μ„λ” μ΄λ¬ν• μ–΄λ…Έν…μ΄μ…μ„ μ μ©ν•  μ μ—†μμ„ μλ―Έν•λ‹¤. μ΄λ¬ν• μ ν•μ€ XML λλ” Spring `@Bean` λ©”μ†λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ…μ‹μ μΌλ΅ 'μ—°κ²°'λμ–΄μ•Ό ν•λ‹¤.

{% endhint %}

## 1.9.3. Fine-tuning Annotation-based Autowiring with `@Primary`

νƒ€μ…λ³„ autowiringμ€ μ—¬λ¬ ν›„λ³΄λ΅ μ΄μ–΄μ§ μ μμΌλ―€λ΅ μ„ νƒ ν”„λ΅μ„Έμ¤λ¥Ό λ” λ§μ΄ μ μ–΄ν•΄μ•Ό ν•λ” κ²½μ°κ°€ λ§λ‹¤. μ΄λ¥Ό μν–‰ν•λ” ν• κ°€μ§€ λ°©λ²•μ€ Springμ `@Primary` μ£Όμ„μ„ μ‚¬μ©ν•λ” κ²ƒμ΄λ‹¤. `@Primary`λ” μ—¬λ¬ λΉμ΄ λ‹¨μΌ κ°’ μμ΅΄μ„±μ— μλ™ μ—°κ²°λ  ν›„λ³΄μΌ λ• νΉμ • λΉμ— μ°μ„  μμ„λ¥Ό λ¶€μ—¬ν•΄μ•Ό ν•¨μ„ λ‚νƒ€λ‚Έλ‹¤. ν›„λ³΄ μ¤‘ μ •ν™•ν ν•λ‚μ primary Beanμ΄ μ΅΄μ¬ν•λ” κ²½μ° μλ™ μ—°κ²° κ°’μ΄ λλ‹¤.

`firstMovieCatalog`λ¥Ό primary `MovieCatalog`λ΅ μ •μν•λ” λ‹¤μ κµ¬μ„±μ„ λ³΄λΌ.

```java
@Configuration
public class MovieConfiguration {

    @Bean
    @Primary
    public MovieCatalog firstMovieCatalog() { ... }

    @Bean
    public MovieCatalog secondMovieCatalog() { ... }

    // ...
}
```

μ΄μ „ κµ¬μ„±μ— μν•΄ λ‹¤μ `MovieRecommender`λ” `firstMovieCatalog`μ™€ μλ™ μ—°κ²°λλ‹¤.

```java
public class MovieRecommender {

    @Autowired
    private MovieCatalog movieCatalog;

    // ...
}
```

## 1.9.4. Fine-tuning Annotation-based Autowiring with Qualifiers

`@Primary`λ” ν•λ‚μ primary ν›„λ³΄λ¥Ό κ²°μ •ν•  μ μλ” κ²½μ° μ—¬λ¬ μΈμ¤ν„΄μ¤μ—μ„ νƒ€μ…λ³„ μλ™ μ—°κ²°μ„ μ‚¬μ©ν•λ” ν¨κ³Όμ μΈ λ°©λ²•μ΄λ‹¤. μ„ νƒ ν”„λ΅μ„Έμ¤λ¥Ό λ” λ§μ΄ μ μ–΄ν•΄μ•Ό ν•λ” κ²½μ° Springμ `@Qualifier` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•  μ μλ‹¤. qualifier κ°’μ„ νΉμ • μΈμμ™€ μ—°κ΄€μ‹μΌ νƒ€μ… μΌμΉ μ„ΈνΈλ¥Ό μΆν€ κ° μΈμμ— λ€ν•΄ νΉμ • λΉμ΄ μ„ νƒλλ„λ΅ ν•  μ μλ‹¤. κ°€μ¥ κ°„λ‹¨ν• κ²½μ° λ‹¤μ μμ™€ κ°™μ΄ μΌλ° μ„¤λ… κ°’μ΄ λ  μ μλ‹¤.

```java
public class MovieRecommender {

    @Autowired
    @Qualifier("main")
    private MovieCatalog movieCatalog;

    // ...
}
```

λ‹¤μ μμ μ™€ κ°™μ΄ κ°λ³„ μƒμ„±μ μΈμ λλ” λ©”μ„λ“ λ§¤κ°λ³€μμ— `@Qualifier` μ–΄λ…Έν…μ΄μ…μ„ μ§€μ •ν•  μλ„ μλ‹¤.

```java
public class MovieRecommender {

    private MovieCatalog movieCatalog;

    private CustomerPreferenceDao customerPreferenceDao;

    @Autowired
    public void prepare(@Qualifier("main") MovieCatalog movieCatalog,
                        CustomerPreferenceDao customerPreferenceDao) {
        this.movieCatalog = movieCatalog;
        this.customerPreferenceDao = customerPreferenceDao;
    }

    // ...
}
```

λΉ μ΄λ¦„μ€ default qualifier κ°’μ΄λ‹¤. λ”°λΌμ„ μ¤‘μ²©λ qualifier μ”μ† λ€μ‹  `main`μ `id`λ΅ λΉμ„ μ •μν•μ—¬ λ™μΌν• μΌμΉ κ²°κ³Όλ¥Ό μ–»μ„ μ μλ‹¤. κ·Έλ¬λ‚ μ΄ κ·μΉ™μ„ μ‚¬μ©ν•μ—¬ νΉμ • λΉμ„ μ΄λ¦„μΌλ΅ μ°Έμ΅°ν•  μ μμ§€λ§ `@Autowired`λ” κΈ°λ³Έμ μΌλ΅ μ„ νƒμ  μλ―Έ qualifierλ¥Ό μ‚¬μ©ν• νƒ€μ… κΈ°λ° μ£Όμ…μ— κ΄€ν• κ²ƒμ΄λ‹¤. μ΄λ” λΉ μ΄λ¦„ ν΄λ°±μ΄ μλ”λΌλ„ qualifier κ°’μ΄ ν•­μƒ νƒ€μ… μΌμΉ μ„ΈνΈ λ‚΄μ—μ„ μ¶•μ† μλ―Έ μ²΄κ³„λ¥Ό κ°–λ”λ‹¤λ” κ²ƒμ„ μλ―Έν•λ‹¤. κ³ μ ν• λΉ `id`μ— λ€ν• μ°Έμ΅°λ¥Ό μλ―Έμ μΌλ΅ ν‘ν„ν•μ§€ μ•λ”λ‹¤. μΆ‹μ€ qualifier κ°’μ€ μ•μ μμ™€ κ°™μ€ μµλ…μ λΉ μ •μμ κ²½μ° μλ™ μƒμ„±λ  μ μλ” λΉ `id`μ™€ λ…λ¦½μ μΈ νΉμ • κµ¬μ„± μ”μ†μ νΉμ„±μ„ ν‘ν„ν•λ” `main` λλ” `EMEA` λλ” `persistent`μ΄λ‹¤.

qualifierλ” μ•μ—μ„ μ„¤λ…ν• λ€λ΅ νƒ€μ…μ΄ μ§€μ •λ μ»¬λ ‰μ…μ—λ„ μ μ©λλ‹¤. μ΄ κ²½μ° μ„ μ–Έλ qualifierμ— λ”°λΌ μΌμΉν•λ” λ¨λ“  λΉμ΄ μ»¬λ ‰μ…μΌλ΅ μ£Όμ…λλ‹¤. μ΄λ” qualifierκ°€ κ³ μ ν•  ν•„μ”κ°€ μ—†μμ„ μλ―Έν•λ‹¤. μ¤νλ ¤ ν•„ν„°λ§ κΈ°μ¤€μ„ κµ¬μ„±ν•λ‹¤. μλ¥Ό λ“¤μ–΄ λ™μΌν• qualifier κ°’ "action"μ„ μ‚¬μ©ν•μ—¬ μ—¬λ¬ `MovieCatalog` λΉμ„ μ •μν•  μ μμΌλ©°, λ¨λ‘ `@Qualifier("action")` μ£Όμ„μ΄ λ‹¬λ¦° `Set<MovieCatalog>`μ— μ£Όμ…λλ‹¤.

{% hint style="success" %}

νƒ€μ… μΌμΉ ν›„λ³΄ λ‚΄μ—μ„ λ€μƒ λΉ μ΄λ¦„μ— λ€ν•΄ qualifier κ°’μ„ μ„ νƒν•κ² ν•λ ¤λ©΄ μ£Όμ… μ§€μ μ—μ„ @Qualifier μ–΄λ…Έν…μ΄μ…μ΄ λ”°λ΅ ν•„μ”ν•μ§€ μ•λ‹¤. λ‹¤λ¥Έ ν•΄κ²° ν‘μ‹κΈ°(μ: qualifier λλ” primary λ§μ»¤κ°™μ€)κ°€ μ—†λ” κ²½μ° κ³ μ ν•μ§€ μ•μ€ μμ΅΄μ„± μƒν™©μ— λ€ν•΄ Springμ€ λ€μƒ λΉ μ΄λ¦„μ— λ€ν•΄ μ£Όμ… μ§€μ  μ΄λ¦„(μ¦‰, ν•„λ“ μ΄λ¦„ λλ” λ§¤κ°λ³€μ μ΄λ¦„)μ„ μΌμΉμ‹ν‚¤κ³  κ°™μ€ μ΄λ¦„μ ν›„λ³΄μκ°€ μλ” κ²½μ° μ„ νƒν•λ‹¤.

{% endhint %}

μ¦‰, μ–΄λ…Έν…μ΄μ… κΈ°λ° μ£Όμ…μ„ μ΄λ¦„μΌλ΅ ν‘ν„ν•λ ¤λ” κ²½μ° νƒ€μ… μΌμΉ ν›„λ³΄ μ¤‘μ—μ„ Bean μ΄λ¦„μΌλ΅ μ„ νƒν•  μ μλ”λΌλ„ `@Autowired`λ¥Ό μ£Όλ΅ μ‚¬μ©ν•μ§€ λ§λΌ. λ€μ‹  `@Resource` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λΌ. μ΄ μ–΄λ…Έν…μ΄μ…μ€ κ³ μ ν• μ΄λ¦„μΌλ΅ νΉμ • λ€μƒ κµ¬μ„±μ”μ†λ¥Ό μ‹λ³„ν•λ„λ΅ μλ―Έλ΅ μ μΌλ΅ μ •μλμ–΄ μμΌλ©° μ„ μ–Έλ νƒ€μ…μ€ μΌμΉ ν”„λ΅μ„Έμ¤μ™€ κ΄€λ ¨μ΄ μ—†λ‹¤. `@Autowired`λ” λ‹¤μ† λ‹¤λ¥Έ μλ―Έλ¥Ό κ°€μ§€κ³  μλ‹¤. νƒ€μ…λ³„λ΅ ν›„λ³΄ λΉμ„ μ„ νƒν• ν›„ μ§€μ •λ `String` qualifier κ°’μ€ ν•΄λ‹Ή νƒ€μ…μ΄ μ„ νƒν• ν›„λ³΄ λ‚΄μ—μ„λ§ κ³ λ ¤λλ‹¤.

μμ²΄μ μΌλ΅ μ»¬λ ‰μ…, λ§µ λλ” λ°°μ—΄ μ ν•μΌλ΅ μ •μλ λΉμ κ²½μ° `@Resource`λ” κ³ μ ν• μ΄λ¦„μΌλ΅ νΉμ • μ»¬λ ‰μ… λλ” λ°°μ—΄ λΉμ„ μ°Έμ΅°ν•λ” ν›λ¥­ν• μ†”λ£¨μ…μ΄λ‹¤. 4.3λ¶€ν„°λ” μ”μ† νƒ€μ… μ •λ³΄κ°€ `@Bean` λ°ν™ νƒ€μ… λλ” μ»¬λ ‰μ… μƒμ† κ³„μΈµ κµ¬μ΅°μ— μ μ§€λλ” ν• Springμ `@Autowired` νƒ€μ… μΌμΉ μ•κ³ λ¦¬μ¦μ„ ν†µν•΄ μ»¬λ ‰μ…, λ§µ λ° λ°°μ—΄ νƒ€μ…μ„ μΌμΉμ‹ν‚¬ μλ„ μλ‹¤. μ΄ κ²½μ° qualifier κ°’μ„ μ‚¬μ©ν•μ—¬ μ΄μ „ λ‹¨λ½μ—μ„ μ„¤λ…ν• λ€λ΅ λ™μΌν• μ ν•μ μ»¬λ ‰μ… μ¤‘μ—μ„ μ„ νƒν•  μ μλ‹¤.

4.3λ¶€ν„° `@Autowired`λ” μ£Όμ…μ„ μ„ν• self referenceλ„ κ³ λ ¤ν•λ‹¤. μμ²΄ μ£Όμ…(self injection)μ€ κΈ°λ³Έμ μΌλ΅ fallbackμ΄λ‹¤. λ‹¤λ¥Έ κµ¬μ„± μ”μ†μ— λ€ν• μΌλ° μμ΅΄μ„±μ΄ ν•­μƒ μ°μ„ ν•λ‹¤. κ·Έλ° μλ―Έμ—μ„ μμ²΄ μ°Έμ΅°λ” μ •κΈ°μ μΈ ν›„λ³΄ μ„ νƒμ— μ°Έμ—¬ν•μ§€ μ•μΌλ―€λ΅ μ°μ„ μ΄ λμ§€ μ•λ”λ‹¤. λ°λ€λ΅, ν•­μƒ κ°€μ¥ λ‚®μ€ μ°μ„  μμ„λ΅ λλ‚λ‹¤. μ‹¤μ λ΅λ” μµν›„μ μλ‹¨μΌλ΅λ§ μμ²΄ μ°Έμ΅°λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ‹¤(μ: λΉμ νΈλμ­μ… ν”„λ΅μ‹λ¥Ό ν†µν•΄ λ™μΌν• μΈμ¤ν„΄μ¤μ—μ„ λ‹¤λ¥Έ λ©”μ„λ“λ¥Ό νΈμ¶ν•λ” κ²½μ°). μ΄λ¬ν• μ‹λ‚λ¦¬μ¤μ—μ„ μν–¥μ„ λ°›λ” λ©”μ†λ“λ¥Ό λ³„λ„μ λΈλ¦¬κ²μ΄νΈ BeanμΌλ΅ λ¶„λ¦¬ν•λ” κ²ƒμ„ κ³ λ ¤ν•λΌ. λλ” `@Resource`λ¥Ό μ‚¬μ©ν•  μλ„ μλ‹¤. μ΄λ¥Όν†µν•΄ κ³ μ ν• μ΄λ¦„μΌλ΅ ν„μ¬ λΉμ— λ€ν• ν”„λ΅μ‹λ¥Ό λ‹¤μ‹ μ–»μ„ μ μλ‹¤.

{% hint style="success" %}

λ™μΌν• κµ¬μ„± ν΄λμ¤μ—μ„ `@Bean` λ©”μ†λ“μ κ²°κ³Όλ¥Ό μ£Όμ…ν•λ ¤λ” μ‹λ„λ” ν¨κ³Όμ μΈ μμ²΄ μ°Έμ΅°(self-reference) μ‹λ‚λ¦¬μ¤μ΄κΈ°λ„ ν•λ‹¤. μ‹¤μ λ΅ ν•„μ”ν• λ©”μ„λ“ signatureμ—μ„ μ΄λ¬ν• μ°Έμ΅°λ¥Ό λλ¦¬κ² ν•΄κ²°ν•κ±°λ‚(κµ¬μ„± ν΄λμ¤μ autowired ν•„λ“μ™€ λ°λ€λ΅) μν–¥μ„ λ°›λ” `@Bean` λ©”μ„λ“λ¥Ό `static`μΌλ΅ μ„ μ–Έν•μ—¬ ν¬ν•¨ν•λ” κµ¬μ„± ν΄λμ¤ μΈμ¤ν„΄μ¤μ™€ ν•΄λ‹Ή λΌμ΄ν”„μ‚¬μ΄ν΄μ—μ„ λ¶„λ¦¬ν•©λ‹λ‹¤. κ·Έλ ‡μ§€ μ•μΌλ©΄ μ΄λ¬ν• λΉμ€ fallback λ‹¨κ³„μ—μ„λ§ κ³ λ ¤λλ©° λ€μ‹  λ‹¤λ¥Έ κµ¬μ„± ν΄λμ¤μ μΌμΉν•λ” λΉ(μ‚¬μ© κ°€λ¥ν• κ²½μ°)μ΄ primary ν›„λ³΄λ΅ μ„ νƒλλ‹¤.

{% endhint %}

`@Autowired`λ” ν•„λ“, μƒμ„±μ λ° λ‹¤μ¤‘ μΈμ λ©”μ„λ“μ— μ μ©λμ–΄ λ§¤κ°λ³€μ μμ¤€μ—μ„ qualifier μ£Όμ„μ„ ν†µν•΄ λ²”μ„λ¥Ό μΆν μ μλ‹¤. λ€μ΅°μ μΌλ΅ `@Resource`λ” λ‹¨μΌ μΈμκ°€ μλ” ν•„λ“ λ° λΉ μ†μ„± setter λ©”μ„λ“μ— λ€ν•΄μ„λ§ μ§€μ›λλ‹¤. κ²°κ³Όμ μΌλ΅ μ£Όμ… λ€μƒμ΄ μƒμ„±μμ΄κ±°λ‚ λ‹¤μ¤‘ μΈμ λ©”μ„λ“μΈ κ²½μ° qualifierλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.

μ»¤μ¤ν…€ qualifier μ–΄λ…Έν…μ΄μ…μ„ μ‘μ„±ν•  μ μλ‹¤. λ‹¤μ μμ μ™€ κ°™μ΄ μ–΄λ…Έν…μ΄μ…μ„ μ •μν•κ³  μ •μ λ‚΄μ— `@Qualifier` μ–΄λ…Έν…μ΄μ…μ„ μ •μν•λ©΄ λλ‹¤.

```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier
public @interface Genre {

    String value();
}
```

μ΄ν›„, λ‹¤μ μμ μ™€ κ°™μ΄ autowired ν•„λ“ λ° λ§¤κ°λ³€μμ— μ»¤μ¤ν…€ qualifierλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

```java
public class MovieRecommender {

    @Autowired
    @Genre("Action")
    private MovieCatalog actionCatalog;

    private MovieCatalog comedyCatalog;

    @Autowired
    public void setComedyCatalog(@Genre("Comedy") MovieCatalog comedyCatalog) {
        this.comedyCatalog = comedyCatalog;
    }

    // ...
}
```

λ‹¤μμΌλ΅ ν›„λ³΄ λΉ μ •μμ— λ€ν• μ •λ³΄λ¥Ό μ κ³µν•  μ μλ‹¤. <qualifier/> νƒκ·Έλ¥Ό <bean/> νƒκ·Έμ ν•μ„ μ”μ†λ΅ μ¶”κ°€ν• λ‹¤μ μ‚¬μ©μ μ •μ ν•μ •μ μ£Όμ„κ³Ό μΌμΉν•λ„λ΅ μ ν•κ³Ό κ°’μ„ μ§€μ •ν•  μ μμµλ‹λ‹¤. μ ν•μ€ μ£Όμ„μ μ •κ·ν™”λ ν΄λμ¤ μ΄λ¦„κ³Ό μΌμΉν•©λ‹λ‹¤. λλ” μ΄λ¦„μ΄ μ¶©λν•  μ„ν—μ΄ μ—†λ” κ²½μ° νΈμμƒ μ§§μ€ ν΄λμ¤ μ΄λ¦„μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤. λ‹¤μ μμ—μ„λ” λ‘ κ°€μ§€ μ ‘κ·Ό λ°©μ‹μ„ λ¨λ‘ λ³΄μ—¬μ¤λ‹λ‹¤.

μ–΄λ–¤ κ²½μ°μ—λ” κ°’ μ—†μ΄ μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•λ” κ²ƒμΌλ΅ μ¶©λ¶„ν•  μ μλ‹¤. μ΄κ²ƒμ€ μ–΄λ…Έν…μ΄μ…μ΄ λ³΄λ‹¤ μΌλ°μ μΈ λ©μ μ„ μ κ³µν•κ³  μ—¬λ¬ λ‹¤λ¥Έ νƒ€μ…μ μμ΅΄μ„±μ— μ μ©λ  μ μμ„ λ• μ μ©ν•λ‹¤. μλ¥Ό λ“¤μ–΄ μΈν„°λ„·μ— μ—°κ²°ν•  μ μ—†μ„ λ• κ²€μƒ‰ν•  μ μλ” μ¤ν”„λΌμΈ μΉ΄νƒλ΅κ·Έλ¥Ό μ κ³µν•  μ μλ‹¤. λ¨Όμ € λ‹¤μ μμ μ™€ κ°™μ΄ κ°„λ‹¨ν• μ–΄λ…Έν…μ΄μ…μ„ μ •μν•λ‹¤.

```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier
public @interface Offline {

}
```

μ΄ν›„, λ‹¤μ μμ μ™€ κ°™μ΄ μλ™ μ—°κ²°λ  ν•„λ“ λλ” μ†μ„±μ— μ–΄λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•λ‹¤.

```java
public class MovieRecommender {

    @Autowired
    @Offline
    private MovieCatalog offlineCatalog;

    // ...
}
```

λΉ μ •μμ—λ” qualifier νƒ€μ…λ§ ν•„μ”ν•κ² λλ‹¤.

λ‹¨μ `value` μ†μ„±μ— μ¶”κ°€λ΅ λλ” λ€μ‹ μ— λ…λ…λ μ†μ„±μ„ ν—μ©ν•λ” μ»¤μ¤ν…€ qualifier μ–΄λ…Έν…μ΄μ…μ„ μ •μν•  μλ„ μλ‹¤. μλ™ μ—°κ²°λ  ν•„λ“λ‚ λ§¤κ°λ³€μμ— μ—¬λ¬ μ†μ„± κ°’μ΄ μ§€μ •λλ©΄ λΉ μ •μλ” μλ™ μ—°κ²° ν›„λ³΄λ΅ κ°„μ£Όλλ” λ¨λ“  μ†μ„± κ°’κ³Ό μΌμΉν•΄μ•Ό ν•λ‹¤. μλ¥Ό λ“¤μ–΄ λ‹¤μ μ–΄λ…Έν…μ΄μ… μ •μλ¥Ό λ³΄μ.

```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier
public @interface MovieQualifier {

    String genre();

    Format format();
}
```

μ΄ κ²½μ° `Format`μ€ λ‹¤μκ³Ό κ°™μ΄ μ •μλ enum ν•μ΄λ‹¤.

```java
public enum Format {
    VHS, DVD, BLURAY
}
```

μλ™ μ—°κ²°λ  ν•„λ“λ” μ»¤μ¤ν…€ qualifierλ΅ μ–΄λ…Έν…μ΄μ…μ΄ λ‹¬λ Έκ³  λ‹¤μ μμ μ™€ κ°™μ΄ λ‘ μ†μ„±(`genre` λ° `format`)μ— λ€ν• κ°’μ„ ν¬ν•¨ν•λ‹¤.

```java
public class MovieRecommender {

    @Autowired
    @MovieQualifier(format=Format.VHS, genre="Action")
    private MovieCatalog actionVhsCatalog;

    @Autowired
    @MovieQualifier(format=Format.VHS, genre="Comedy")
    private MovieCatalog comedyVhsCatalog;

    @Autowired
    @MovieQualifier(format=Format.DVD, genre="Action")
    private MovieCatalog actionDvdCatalog;

    @Autowired
    @MovieQualifier(format=Format.BLURAY, genre="Comedy")
    private MovieCatalog comedyBluRayCatalog;

    // ...
}
```

## 1.9.5. Using Generics as Autowiring Qualifiers

`@Qualifier` μ–΄λ…Έν…μ΄μ…μ— μ¶”κ°€ν•μ—¬ Java μ λ„¤λ¦­ νƒ€μ…μ„ μ•”μ‹μ  qualification ν•μ‹μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤. μλ¥Ό λ“¤μ–΄ λ‹¤μ κµ¬μ„±μ΄ μλ‹¤κ³  κ°€μ •ν•μ.

```java
@Configuration
public class MyConfiguration {

    @Bean
    public StringStore stringStore() {
        return new StringStore();
    }

    @Bean
    public IntegerStore integerStore() {
        return new IntegerStore();
    }
}
```

μ•μ λΉμ΄ generic μΈν„°νμ΄μ¤(μ¦‰, `Store<String>` λ° `Store<Integer>`)λ¥Ό κµ¬ν„ν•λ‹¤κ³  κ°€μ •ν•λ©΄ λ‹¤μ μμ μ™€ κ°™μ΄ `Store` μΈν„°νμ΄μ¤λ¥Ό `@Autowire`ν•  μ μκ³  genericμ€ qualifierλ΅ μ‚¬μ©λλ‹¤.

```java
@Autowired
private Store<String> s1; // <String> qualifier, injects the stringStore bean

@Autowired
private Store<Integer> s2; // <Integer> qualifier, injects the integerStore bean
```

Generic qualifierλ” λ¦¬μ¤νΈ, Map μΈμ¤ν„΄μ¤ λ° λ°°μ—΄μ„ μλ™ μ—°κ²°ν•λ” κ²½μ°μ—λ„ μ μ©λλ‹¤. λ‹¤μ μμ λ” generic `List`λ¥Ό μλ™ μ—°κ²°ν•λ‹¤.

```java
// Inject all Store beans as long as they have an <Integer> generic
// Store<String> beans will not appear in this list
@Autowired
private List<Store<Integer>> s;
```

## 1.9.7. Injection with `@Resource`

Springμ€ λν• ν•„λ“ λλ” λΉ μ†μ„± setter λ©”μ†λ“μ— `@Resource` μ–΄λ…Έν…μ΄μ…(javax.annotation.Resource)μ„ μ‚¬μ©ν•μ—¬ μ£Όμ…μ„ μ§€μ›ν•λ‹¤. Springμ€ Spring κ΄€λ¦¬ κ°μ²΄μ— λ€ν•΄μ„λ„ μ΄ ν¨ν„΄μ„ μ§€μ›ν•λ‹¤.

`@Resource`λ” μ΄λ¦„ μ†μ„±μ„ μ‚¬μ©ν•λ‹¤. κΈ°λ³Έμ μΌλ΅ Springμ€ ν•΄λ‹Ή κ°’μ„ μ£Όμ…ν•  λΉ μ΄λ¦„μΌλ΅ ν•΄μ„ν•λ‹¤. λ‹¤μ μμ μ—μ„ λ³Ό μ μλ“―μ΄ μ΄λ¦„λ³„ μλ―Έ μ²΄κ³„λ¥Ό λ”°λ¥Έλ‹¤.

```java
public class SimpleMovieLister {

    private MovieFinder movieFinder;

    @Resource(name="myMovieFinder")
    public void setMovieFinder(MovieFinder movieFinder) {
        this.movieFinder = movieFinder;
    }
}
```

μ΄λ¦„μ„ λ…μ‹μ μΌλ΅ μ§€μ •ν•μ§€ μ•μΌλ©΄ κΈ°λ³Έ μ΄λ¦„μ€ ν•„λ“ μ΄λ¦„ λλ” setter λ©”μ„λ“μ—μ„ νμƒλλ‹¤. ν•„λ“μ κ²½μ° ν•„λ“ μ΄λ¦„μ„ μ‚¬μ©ν•©λ‹λ‹¤. setter λ©”μ†λ“μ κ²½μ° Bean μ†μ„±λ…μ„ μ·¨ν•λ‹¤. λ‹¤μ μμ μ—μ„λ” MovieFinderλΌλ” μ΄λ¦„μ λΉμ„ setter λ©”μ„λ“μ— μ‚½μ…ν•λ‹¤.

```java
public class SimpleMovieLister {

    private MovieFinder movieFinder;

    @Resource
    public void setMovieFinder(MovieFinder movieFinder) {
        this.movieFinder = movieFinder;
    }
}
```

λ…μ‹μ  μ΄λ¦„μ΄ μ§€μ •λμ§€ μ•κ³  `@Autowired`μ™€ μ μ‚¬ν•κ² `@Resource` μ‚¬μ©λλ” κ²½μ° `@Resource`λ” νΉμ • λ…λ…λ λΉ λ€μ‹  μ°μ„  νƒ€μ… μΌμΉλ¥Ό μ°Ύκ³  μ μ•λ ¤μ§„ ν•΄κ²° κ°€λ¥ν• μμ΅΄μ„±μ„ ν•΄κ²°ν•λ‹¤.(`BeanFactory`, `ApplicationContext`, `ResourceLoader`, `ApplicationEventPublisher` λ° `MessageSource` μΈν„°νμ΄μ¤)

λ”°λΌμ„ λ‹¤μ μμ—μ„ `customerPreferenceDao` ν•„λ“λ” λ¨Όμ € "customerPreferenceDao"λΌλ” μ΄λ¦„μ λΉμ„ μ°Ύμ€ λ‹¤μ `CustomerPreferenceDao` νƒ€μ…μ— λ€ν• primary νƒ€μ… μΌμΉλ΅ ν΄λ°±ν•λ‹¤.

```java
public class MovieRecommender {

    @Resource
    private CustomerPreferenceDao customerPreferenceDao;

    @Resource
    private ApplicationContext context;

    public MovieRecommender() {
    }

    // ...
}
```

`context` ν•„λ“λ” μ•λ ¤μ§„ ν•΄κ²° κ°€λ¥ν• μμ΅΄μ„± μ ν•μ„ κΈ°λ°μΌλ΅ μ£Όμ…λλ‹¤ : `ApplicationContext`

## 1.9.8. Using `@Value`

`@Value`λ” μΌλ°μ μΌλ΅ μ™Έλ¶€ μ†μ„±μ„ μ£Όμ…ν•λ” λ° μ‚¬μ©λλ‹¤.

```java
@Component
public class MovieRecommender {

    private final String catalog;

    public MovieRecommender(@Value("${catalog.name}") String catalog) {
        this.catalog = catalog;
    }
}
```

λ‹¤μ κµ¬μ„±κ³Ό κ°™μ΄ μ‚¬μ©λλ‹¤.

```java
@Configuration
@PropertySource("classpath:application.properties")
public class AppConfig { }
```

`application.properties` νμΌ λ‚΄μ©

```xml
catalog.name=MovieCatalog
```

μ΄ κ²½μ° `catalog` λ§¤κ°λ³€μ λ° ν•„λ“λ” `MovieCatalog` κ°’κ³Ό λ™μΌν•λ‹¤.

μ†μ„± κ°’μ„ ν™•μΈν•λ ¤κ³  μ‹λ„ν•κ³  ν™•μΈν•  μ μ—†λ” κ²½μ° μ†μ„± μ΄λ¦„(μ: `${catalog.name}`)μ΄ κ°’μΌλ΅ μ‚½μ…λλ‹¤. μ΅΄μ¬ν•μ§€ μ•λ” κ°’μ— λ€ν• μ—„κ²©ν• μ μ–΄λ¥Ό μ μ§€ν•λ ¤λ©΄ λ‹¤μ μμ μ™€ κ°™μ΄ `PropertySourcesPlaceholderConfigurer` λΉμ„ μ„ μ–Έν•΄μ•Ό ν•λ‹¤.

```java
@Configuration
public class AppConfig {

    @Bean
    public static PropertySourcesPlaceholderConfigurer propertyPlaceholderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
    }
}
```

JavaConfigλ¥Ό μ‚¬μ©ν•μ—¬ `PropertySourcesPlaceholderConfigurer`λ¥Ό κµ¬μ„±ν•  λ• `@Bean` λ©”μ†λ“λ” `static`μ΄μ–΄μ•Ό ν•λ‹¤.

μ„μ κµ¬μ„±μ„ μ‚¬μ©ν•λ©΄ `${}` placeholderλ¥Ό ν™•μΈν•  μ μ—†λ” κ²½μ° Spring μ΄κΈ°ν™” μ‹¤ν¨λ¥Ό λ³΄μ¥ν•λ‹¤. `setPlaceholderPrefix`, `setPlaceholderSuffix` λλ” `setValueSeparator`μ™€ κ°™μ€ λ©”μ„λ“λ¥Ό μ‚¬μ©ν•μ—¬ placeholderλ¥Ό μ»¤μ¤ν…€ν™”ν•  μλ„ μλ‹¤.

{% hint style="success" %}

Spring Bootλ” κΈ°λ³Έμ μΌλ΅ `application.properties` λ° `application.yml` νμΌμ—μ„ μ†μ„±μ„ κ°€μ Έμ¤λ” `PropertySourcesPlaceholderConfigurer` λΉμ„ κµ¬μ„±ν•λ‹¤.

{% endhint %}

Springμ—μ„ μ κ³µν•λ” λ‚΄μ¥ λ³€ν™κΈ° μ§€μ›μ„ ν†µν•΄ κ°„λ‹¨ν• νƒ€μ… λ³€ν™(μ: `Integer` λλ” `int`λ΅)μ„ μλ™μΌλ΅ μ²λ¦¬ν•  μ μλ‹¤. μ—¬λ¬ κ°μ μ‰Όν‘λ΅ κµ¬λ¶„λ κ°’μ„ μ¶”κ°€ν•μ—¬ μλ™μΌλ΅ λ¬Έμμ—΄ λ°°μ—΄λ΅ λ³€ν™ν•  μ μλ‹¤.

λ‹¤μκ³Ό κ°™μ΄ default κ°’μ„ μ κ³µν•  μ μλ‹¤.

```java
@Component
public class MovieRecommender {

    private final String catalog;

    public MovieRecommender(@Value("${catalog.name:defaultCatalog}") String catalog) {
        this.catalog = catalog;
    }
}
```

Spring `BeanPostProcessor`λ” λ’¤μ—μ„ `ConversionService`λ¥Ό μ‚¬μ©ν•μ—¬ `@Value`μ `String` κ°’μ„ λ€μƒ νƒ€μ…μΌλ΅ λ³€ν™ν•λ” ν”„λ΅μ„Έμ¤λ¥Ό μ²λ¦¬ν•λ‹¤. κ³ μ ν• μ»¤μ¤ν…€ νƒ€μ…μ— λ€ν• λ³€ν™ μ§€μ›μ„ μ κ³µν•λ ¤λ©΄ λ‹¤μ μμ μ™€ κ°™μ΄ κ³ μ ν• `ConversionService` λΉ μΈμ¤ν„΄μ¤λ¥Ό μ κ³µν•  μ μλ‹¤.

```java
@Configuration
public class AppConfig {

    @Bean
    public ConversionService conversionService() {
        DefaultFormattingConversionService conversionService = new DefaultFormattingConversionService();
        conversionService.addConverter(new MyCustomConverter());
        return conversionService;
    }
}
```

`@Value`μ— [`SpEL` ν‘ν„μ‹](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#expressions) μ΄ ν¬ν•¨λ κ²½μ° κ°’μ€ λ‹¤μ μμ μ™€ κ°™μ΄ λ°νƒ€μ„μ— λ™μ μΌλ΅ κ³„μ‚°λ©λ‹λ‹¤.

```java
@Component
public class MovieRecommender {

    private final String catalog;

    public MovieRecommender(@Value("#{systemProperties['user.catalog'] + 'Catalog' }") String catalog) {
        this.catalog = catalog;
    }
}
```

SpELμ€ λν• λ” λ³µμ΅ν• λ°μ΄ν„° κµ¬μ΅°μ μ‚¬μ©μ΄ κ°€λ¥ν•λ‹¤.

```java
@Component
public class MovieRecommender {

    private final Map<String, Integer> countOfMoviesPerCatalog;

    public MovieRecommender(
            @Value("#{{'Thriller': 100, 'Comedy': 300}}") Map<String, Integer> countOfMoviesPerCatalog) {
        this.countOfMoviesPerCatalog = countOfMoviesPerCatalog;
    }
}
```

## 1.9.9. Using `@PostConstruct` and `@PreDestroy`

`CommonAnnotationBeanPostProcessor`λ” `@Resource` μ–΄λ…Έν…μ΄μ…λΏλ§ μ•„λ‹λΌ μλ… μ£ΌκΈ° μ–΄λ…Έν…μ΄μ…(`javax.annotation.PostConstruct` λ° `javax.annotation.PreDestroy`)λ„ μΈμ‹ν•λ‹¤. Spring 2.5μ— λ„μ…λ μ΄λ¬ν• μ–΄λ…Έν…μ΄μ…μ— λ€ν• μ§€μ›μ€ [μ΄κΈ°ν™” μ½λ°±](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-lifecycle-initializingbean) λ° [μ†λ©Έ μ½λ°±](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-lifecycle-disposablebean) μ— μ„¤λ…λ λΌμ΄ν”„ μ½λ°± λ©”μ»¤λ‹μ¦μ— λ€ν• λ€μ•μ„ μ κ³µν•λ‹¤. `CommonAnnotationBeanPostProcessor`κ°€ Spring `ApplicationContext` λ‚΄μ— λ“±λ΅λ κ²½μ° μ΄λ¬ν• μ–΄λ…Έν…μ΄μ… μ¤‘ ν•λ‚λ¥Ό μ „λ‹¬ν•λ” λ©”μ†λ“λ” ν•΄λ‹Ή Spring λΌμ΄ν”„μ‚¬μ΄ν΄ μΈν„°νμ΄μ¤ λ©”μ†λ“ λλ” λ…μ‹μ μΌλ΅ μ„ μ–Έλ μ½λ°± λ©”μ†λ“μ™€ λ™μΌν• λΌμ΄ν”„μ‚¬μ΄ν΄ μ‹μ μ—μ„ νΈμ¶λλ‹¤. λ‹¤μ μμ—μ„ μΊμ‹λ” μ΄κΈ°ν™” μ‹ λ―Έλ¦¬ μ±„μ›μ§€κ³  μ†λ©Έ μ‹ μ§€μ›μ§„λ‹¤.

```java
public class CachingMovieLister {

    @PostConstruct
    public void populateMovieCache() {
        // populates the movie cache upon initialization...
    }

    @PreDestroy
    public void clearMovieCache() {
        // clears the movie cache upon destruction...
    }
}
```

λ‹¤μ–‘ν• λΌμ΄ν”„ μ‚¬μ΄ν΄ λ©”μ»¤λ‹μ¦ κ²°ν•©μ ν¨κ³Όμ— λ€ν• μμ„Έν• λ‚΄μ©μ€ [λΌμ΄ν”„ μ‚¬μ΄ν΄ λ©”μ»¤λ‹μ¦ κ²°ν•©](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-lifecycle-combined-effects) μ„ μ°Έμ΅°ν•λΌ.

`@Resource`μ™€ λ§μ°¬κ°€μ§€λ΅ `@PostConstruct` λ° `@PreDestroy` μ–΄λ…Έν…μ΄μ… νƒ€μ…μ€ JDK 6μ—μ„ 8κΉμ§€μ ν‘μ¤€ Java λΌμ΄λΈλ¬λ¦¬μ μΌλ¶€μ€λ‹¤. κ·Έλ¬λ‚ μ „μ²΄ `javax.annotation` ν¨ν‚¤μ§€λ” JDK 9μ ν•µμ‹¬ Java λ¨λ“μ—μ„ λ¶„λ¦¬λμ–΄ κ²°κµ­ JDK 11μ—μ„ μ κ±°λμ—λ‹¤. ν•„μ”ν• κ²½μ° `javax.annotation-api` artifactλ” λ‹¤λ¥Έ λΌμ΄λΈλ¬λ¦¬μ²λΌ μ• ν”λ¦¬μΌ€μ΄μ…μ ν΄λμ¤ κ²½λ΅μ— μ¶”κ°€ν•κΈ° μ„ν•΄ μ§€κΈ Maven Centralμ„ ν†µν•΄ μ–»μ–΄μ™€μ•Ό ν•λ‹¤.