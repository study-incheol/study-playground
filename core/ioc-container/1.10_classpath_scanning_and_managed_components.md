# 1.10. Classpath Scanning and Managed Components

> [1.10. Classpath Scanning and Managed Components](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-classpath-scanning) μ±•ν„°λ¥Ό μ”μ•½ν• λ‚΄μ©μ…λ‹λ‹¤.

μ΄ μ¥μ λ€λ¶€λ¶„μ μμ λ” κ° BeanDefinitionμ„ μƒμ„±ν•κΈ° μ„ν•΄μ„ XMLλ°©μ‹μΌλ΅ λ©”νƒ€λ°μ΄ν„°λ¥Ό κµ¬μ„±ν•©λ‹λ‹¤. 

μ΄μ „ μ„Ήμ…(μ–΄λ…Έν…μ΄μ… κΈ°λ° μ»¨ν…μ΄λ„ κµ¬μ„±)μ—μ„λ” μ†μ¤ λ λ²¨ μ£Όμ„μ„ ν†µν•΄ λ§μ€ λ©”νƒ€λ°μ΄ν„°λ¥Ό κµ¬μ„±ν•λ” λ°©λ²•μ„ μ„¤λ…ν–μ§€λ§, λΉ μ •μλ¥Ό XMLλ΅ κµ¬μ„±ν•κ³ , μΆ…μ†μ„± μ£Όμ…μ„ μ„ν•΄ μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν• μκ°€ μ „λ¶€μ€μµλ‹λ‹¤. 

μ΄ μ μ—μ„λ” ν΄λμ¤ κ²½λ΅λ¥Ό κ²€μƒ‰ν•μ—¬ μ»΄ν¬λ„νΈλ¥Ό μ•”μ‹μ μΌλ΅ νƒμ§€ν•λ” λ°©λ²•μ— λ€ν•΄ μ„¤λ…ν•©λ‹λ‹¤. 

μ»΄ν¬λ„νΈλ” ν•„ν„° κΈ°μ¤€κ³Ό μΌμΉν•λ©° μ»¨ν…μ΄λ„μ— λ“±λ΅λ ν•΄λ‹Ή λΉ μ •μκ°€ μλ” ν΄λμ¤μ…λ‹λ‹¤. μ΄λ ‡κ² ν•λ©΄ λΉμ„ λ“±λ΅ν•κΈ° μ„ν•΄ XMLμ„ μ΄μ©ν•μ§€ μ•μ•„λ„ λ©λ‹λ‹¤. 

λ€μ‹  μ£Όμ„(μ: @Component), AspectJ ν‘ν„μ‹ λλ” μ‚¬μ©μ μ •μ ν•„ν„° κΈ°μ¤€μ„ μ‚¬μ©ν•μ—¬ νΉμ • μ»΄ν¬λ„νΈλ¥Ό μ„ νƒν•  μ μμµλ‹λ‹¤.

{% hint style="success" %}

#### π’΅ 

μ¤ν”„λ§ 3.0 λ²„μ „λ¶€ν„°, μ¤ν”„λ§ μλ°” config ν”„λ΅μ νΈκ°€ μ κ³µν•λ” λ§μ€ κΈ°λ¥λ“¤μ€ μ¤ν”„λ§ ν”„λ΅μ νΈμ ν•µμ‹¬μ…λ‹λ‹¤. μ΄ κΈ°λ¥λ“¤μ€ κΈ°μ΅΄ XMLλ°©μ‹μ„ λ€μ‹ ν•΄μ„, μλ°”λ¥Ό μ΄μ©ν•΄ λΉμ„ μ •μν•  μ μλ„λ΅ ν•©λ‹λ‹¤.

μƒ κΈ°λ¥μ μμ λ” @Configuration, @Bean, @Import λ° @DependsOn μ£Όμ„μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. 

{% endhint %}

## 1.10.1 `@Component` and Further Stereotype Annotations

`@Repository`μ€ λ°μ΄ν„°λ¥Ό μ ‘κ·Όν•λ” μ—­ν•  νΉμ€ stereotypeμ„ λ§μ΅±ν•λ” ν΄λμ¤λ¥Ό ν‘μ‹ν•κΈ° μ„ν•΄ μ‚¬μ©λλ‹¤. μ΄ μ–΄λ…Έν…μ΄μ…μ κΈ°λ¥ μ¤‘ [Exception Translation](https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#orm-exception-translation)μ— μ†κ°λκ²ƒμ²λΌ μμ™Έλ¥Ό μλ™μΌλ΅ λ³€ν™ν•΄μ£Όλ” κΈ°λ¥λ„ ν¬ν•¨ν•©λ‹λ‹¤.

Spring provides further stereotype annotations: @Component, @Service, and @Controller. @Component is a generic stereotype for any Spring-managed component. @Repository, @Service, and @Controller are specializations of @Component for more specific use cases (in the persistence, service, and presentation layers, respectively). Therefore, you can annotate your component classes with @Component, but, by annotating them with @Repository, @Service, or @Controller instead, your classes are more properly suited for processing by tools or associating with aspects. For example, these stereotype annotations make ideal targets for pointcuts. @Repository, @Service, and @Controller can also carry additional semantics in future releases of the Spring Framework. Thus, if you are choosing between using @Component or @Service for your service layer, @Service is clearly the better choice. Similarly, as stated earlier, @Repository is already supported as a marker for automatic exception translation in your persistence layer.

μ¤ν”„λ§μ€ λ‹¤μ–‘ν• streotype μ–΄λ…Έν…μ΄μ…μ„ μ κ³µν•©λ‹λ‹¤. `@Component, @Service, @Controller`

`@Component`λ” μ¤ν”„λ§μ΄ κ΄€λ¦¬ν•λ” λ¨λ“  μ»΄ν¬λ„νΈμ— λ€ν• μΌλ° streotype μ…λ‹λ‹¤. 

`@Repository, @Service κ·Έλ¦¬κ³  @Controller`λ” @Componentμ μ©λ„λ¥Ό μ„Έλ¶„ν™”ν•μ—¬ μ‚¬μ©ν•  λ• μ‚¬μ©λ©λ‹λ‹¤.(κ°κ° persistence,service,presentation λ μ΄μ–΄λ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤.)

κ·Έλ¬λ―€λ΅ λ¨λ“  μ»΄ν¬λ„νΈμ— @Componentλ¥Ό μ‚¬μ©ν•  μ μμ§€λ§, @Repository, @Service, @Controllerλ¥Ό μ‚¬μ©ν•¨μΌλ΅μ¨, μ¤ν”„λ§μ€ κ° μ»΄ν¬λ„νΈλ¥Ό μΆ€ λ” μ©λ„μ— λ§λ„λ΅ μ„¤μ •ν•©λ‹λ‹¤.(aspectμ„¤μ •)

μλ¥Ό λ“¤μ–΄μ„, μ΄λ¬ν• μ¤ν…λ μ¤νƒ€μ…μ€ ν¬μΈνΈ μ»·μ λ€μƒμ΄ λ©λ‹λ‹¤. κ·Έλ¦¬κ³  μ΄ν›„ λ¦΄λ¦¬μ¦μ—μ„ μλ―Έκ°€ ν™•μ¥λ  μ μκΈ°λ•λ¬Έμ—, μ„λΉ„μ¤ λ μ΄μ–΄μ— λ€ν•΄μ„ μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•  λ• @Serviceλ¥Ό μ‚¬μ©ν•λ”κ²ƒμ΄ λ°”λμ§ν•©λ‹λ‹¤. μ• μ„ μ–ΈκΈ‰λλ“―μ΄, @Repositoryλ” μ΄λ―Έ μμ™Έλ¥Ό λ³€ν™ν•΄μ£Όλ” λ§μ»¤λ΅μ¨ μ‚¬μ©λκ³  μμµλ‹λ‹¤.

## 1.10.2 Using Meta-annotations and Composed Annotations

μ¤ν”„λ§μ—μ„ μ κ³µν•λ” λ§μ€ μ–΄λ…Έν…μ΄μ…μ€ λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μΌλ΅μ¨ μ‚¬μ©λ  μ μμµλ‹λ‹¤. λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μ€ λ‹¤λ¥Έ μ–΄λ…Έν…μ΄μ…μ— μ μ©ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄μ„, @Componentλ” λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μΌλ΅μ¨, @Service μ–΄λ…Έν…μ΄μ…μ— μ‚¬μ©λκ³  μμµλ‹λ‹¤.

``` java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Component -- [1]
public @interface Service {

    // ...
}
```
* [1] @Serviceκ°€ @Componentμ™€ κ°™μ΄ μ·¨κΈ‰λλ„λ΅ λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μΌλ΅ μ‚¬μ©ν•©λ‹λ‹¤.

λλ” μ—¬λ¬ λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μ„ νΌν•©ν•μ—¬ μƒλ΅μ΄ μ–΄λ…Έν…μ΄μ…μ„ κµ¬μ„±ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤λ©΄, @RestControllerλ” @Controllerμ™€ @ResponseBodyμΌλ΅ νΌν•© κµ¬μ„±λ μ–΄λ…Έν…μ΄μ…μ…λ‹λ‹¤.

``` java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Controller
@ResponseBody
public @interface RestController {

    // ...
}
```

μ¶”κ°€μ μΌλ΅, νΌν•© μ–΄λ…Έν…μ΄μ…μ€ λ©”νƒ€μ–΄λ…Έν…μ΄μ…μ μ†μ„±μ„ μ¬ κµ¬μ„±ν•  μ μμµλ‹λ‹¤. μ΄ κΈ°λ²•μ€ λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μ μ†μ„±μ„ λ¶€λ¶„μ μΌλ΅λ§ μ‚¬μ©ν•κΈ° μ›ν•  λ• ν¨κ³Όμ μ…λ‹λ‹¤. μλ¥Ό λ“¤μ–΄μ„, `@SessionScope`μ€ μ¤μ½”ν”„ μ΄λ¦„μ€ `session`μΌλ΅ μ§€μ •λμ–΄μμ§€λ§, `proxyMod`λ” λ³€κ²½ κ°€λ¥ν•©λ‹λ‹¤. μ•„λλ” `@SessionScope`μ μ •μμ…λ‹λ‹¤.
``` java
@Target({ElementType.TYPE, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Scope(WebApplicationContext.SCOPE_SESSION)
public @interface SessionScope {

    /**
     * Alias for {@link Scope#proxyMode}.
     * <p>Defaults to {@link ScopedProxyMode#TARGET_CLASS}.
     */
    @AliasFor(annotation = Scope.class)
    ScopedProxyMode proxyMode() default ScopedProxyMode.TARGET_CLASS;

}
``` 

μ•„λλ” `@SessionScope` proxyMode μ†μ„±μ μ‚¬μ©μ— λ”°λ¥Έ μμ λ“¤μ…λ‹λ‹¤.

``` java
@Service
@SessionScope
public class SessionScopedService {
    // ...
}
```

``` java
@Service
@SessionScope(proxyMode = ScopedProxyMode.INTERFACES)
public class SessionScopedUserService implements UserService {
    // ...
}
```

λ” μμ„Έν• λ‚΄μ©μ€ [Spring Annotation Programming Model](https://github.com/spring-projects/spring-framework/wiki/Spring-Annotation-Programming-Model)λ¥Ό μ°Έκ³ ν•μ„Έμ”.


## 1.10.3 Automatically Detecting Classes and Registering Bean Definitions

μ¤ν”„λ§μ€ μλ™μΌλ΅ μ¤ν…λ μ¤ νƒ€μ…μ ν΄λμ¤λ¥Ό νƒμ§€ν•κ³ , μ–΄ν”λ¦¬μΌ€μ΄μ… μ»¨ν…μ¤νΈμ— κ·Έμ— λ€μ‘ν•λ” λΉ μ •μλ¥Ό λ“±λ΅ν•©λ‹λ‹¤. μλ¥Ό λ“¤μ–΄μ„ μ•„λ 2 ν΄λμ¤λ“¤μ€ μ¤ν”„λ§μ— μν•΄ μλ™μΌλ΅ νƒμ§€λ©λ‹λ‹¤.
``` java
@Service
public class SimpleMovieLister {

    private MovieFinder movieFinder;

    public SimpleMovieLister(MovieFinder movieFinder) {
        this.movieFinder = movieFinder;
    }
}
```
``` java
@Repository
public class JpaMovieFinder implements MovieFinder {
    // implementation elided for clarity
}
```

ν΄λμ¤λ“¤μ„ μλ™νƒμ§€ν•κ³  λΉμΌλ΅ λ“±λ΅ν•κΈ°μ„ν•΄μ„, basePackages μ†μ„±μ΄ ν΄λμ¤λ“¤μ κ³µν†µ λ¶€λ¨ν¨ν‚¤μ§€μΈ `@ComponentScan`μ„ `@Configuration` ν΄λμ¤μ— μ¶”κ°€ν•΄μ•Όν•©λ‹λ‹¤. (ν΄λμ¤λ“¤μ λ¶€λ¨ν¨ν‚¤μ§€λ¥Ό μ½¤λ§λ‚, μ„Έλ―Έμ½λ΅ , μ¤νμ΄μ¤λ΅ λ¶„λ¦¬ν• λ¦¬μ¤νΈλ΅ κµ¬μ„±ν•  μλ„ μμµλ‹λ‹¤.)
``` java
@Configuration
@ComponentScan(basePackages = "org.example")
public class AppConfig  {
    // ...
}
```

{% hint style="success" %}

#### π’΅ 

μ„ μμ λ¥Ό, @ComponentScan μ–΄λ…Έν…μ΄μ…μ valueμ†μ„±μ„ μ΄μ©ν•μ—¬ μ΅°κΈ λ” λ‹¨μν™” μ‹ν‚¬ μ μμµλ‹λ‹¤. `@componentScan("org.example")`

{% endhint %}

{% hint style="success" %}

#### π’΅ 

ν΄λμ¤ν¨μ¤ ν¨ν‚¤μ§€λ“¤μ„ μ¤μΊ”ν•λ ¤λ©΄ ν΄λμ¤ν¨μ¤μ— λ€μ‘ν•λ” λ””λ ‰ν† λ¦¬λ“¤μ μ—”νΈλ¦¬κ°€ μ΅΄μ¬ν•΄μ•Όλ§ ν•©λ‹λ‹¤. Jarsλ“¤μ„ Antλ΅ λΉλ“ν• λ•, files-only JAR νƒμ¤ν¬ μµμ…μ„ ν™μ„±ν™”μ§€μ•λ„λ΅ μ£Όμν•μ„Έμ”. λν• ν΄λμ¤ν¨μ¤ λ””λ ‰ν† λ¦¬λ“¤μ΄ νΉμ •ν™κ²½μ—μ„ λ³΄μ•μ •μ±…μΌλ΅ μ°Έμ΅°λμ§€ λ»ν•λ” κ²½μ°κ°€ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, JDK 1.7.0_45 νΉμ€ κ·Έ μ΄ν›„λ²„μ „μ΄ ν•΄λ‹Ήλ  μ μμµλ‹λ‹¤.(λ‹Ήμ‹ μ manifestsμ— "Trusted-Library" μ„¤μ •μ΄ ν•„μ”ν•©λ‹λ‹¤. - μμ„Έν• λ‚΄μ©μ€ [https://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources](https://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources)λ¥Ό μ°Έκ³ ν•μ„Έμ”.)

JDK 9 λ¨λ“κ²½λ΅(jigsaw)μ—μ„λ” μ¤ν”„λ§μ ν΄λμ¤ν¨μ¤ μ¤μΊλ‹μ€ μΌλ°μ μΌλ΅ μ λ™μ‘ν•μ§€λ§, λ‹Ήμ‹ μ μ»΄ν¬λ„νΈ ν΄λμ¤λ“¤μ΄ `module-info` λ””μ¤ν¬λ¦½ν„°μ— export λμ—λ”μ§€ μ²΄ν¬κ°€ ν•„μ”ν•©λ‹λ‹¤. λ§μ•½ μ¤ν”„λ§μ΄ μ ‘κ·Όμ ν•μκ°€ publicμ΄ μ•„λ‹ μ†μ„±μ— λ€ν•΄μ„λ„ μ„¤μ •ν•κΈ°λ¥Ό μ›ν•λ‹¤λ©΄, ν΄λμ¤λ“¤μ΄ `module-info` λ””μ¤ν¬λ¦½ν„°μ— "exports" μ„ μ–Έ λ€μ‹ μ— "opens"λ΅ μ„ μ–Έλμ–΄μλ”μ§€ ν™•μΈμ΄ ν•„μ”ν•©λ‹λ‹¤.

{% endhint %}

μ¶”κ°€μ μΌλ΅ `AutowiredAnnotationBeanPostProcessor` κ·Έλ¦¬κ³  `CommonAnnotationBeanPostProcessor`λ” μ»΄ν¬λ„νΈ μ¤μΊ”κΈ°λ¥μ„ μ‚¬μ©ν•  λ•, μλ™μΌλ΅ μ»¨ν…μ¤νΈμ— ν¬ν•¨λ©λ‹λ‹¤. μ¦‰, λ‘ μ»΄ν¬λ„νΈλ“¤μ€ κµ¬μ„±μ •λ³΄λ“¤μ„ μ κ³µν•μ§€ μ•κ³ λ„, μλ™μΌλ΅ νƒμ§€λκ³ , μμ΅΄μ„± μ£Όμ…μ΄ μ΄λ¤„μ§‘λ‹λ‹¤. 

## 1.10.4 Using Filters to Customize Scanning

`@Component`,`@Repository`,`@Service`,`@Controller`,`@Configuration`λ΅ λ§ν‚Ήλ ν΄λμ¤λ“¤μ΄κ±°λ‚, `@Component`λ¥Ό λ©”νƒ€ μ–΄λ…Έν…μ΄μ…μΌλ΅ μ‚¬μ©ν•κ³  μλ” μ»¤μ¤ν…€ μ–΄λ…Έν…μ΄μ… ν΄λμ¤λ“¤μ€ κΈ°λ³Έμ μΌλ΅ μ»΄ν¬λ„νΈ ν›„λ³΄λ΅ νƒμ§€λ©λ‹λ‹¤. ν•μ§€λ§ `@ComponentScan`μ–΄λ…Έν…μ΄μ…μ `includeFilters` νΉμ€ `excludeFilters` μ†μ„±μ„ μ΄μ©ν•΄μ„ νƒμ§€λλ” λ€μƒμ„ ν™•μ¥μ‹ν‚¤κ±°λ‚, μ ν•ν•  μ μμµλ‹λ‹¤. κ° ν•„ν„°λ“¤μ€ `type`,`expression`μ†μ„±μ΄ ν•„μ”ν•λ©°, μ•„λμ ν‘λ” ν•„ν„°λ§ μµμ…μ„ μ„¤λ…ν•©λ‹λ‹¤.

** Table 5. Filter Types **
Filter Type|Example Expression|Description
--|--|--
annotation(default)|`org.example.SomeAnnotation`|νƒ€μ…λ λ²¨μ—μ„ (λ©”νƒ€)μ–΄λ…Έν…μ΄μ…μ΄ μ‚¬μ©λ κ²½μ°
assignable|`org.example.SomeClass`|νƒ€κ² μ»΄ν¬λ„νΈλ“¤μ΄ ν•μ„νΈν™μ΄ κ°€λ¥ν• ν΄λμ¤λ‚ μΈν„°νμ΄μ¤
aspectj|`org.example..*Service+`|aspectj ν‘ν„μ‹μ— λ§¤μΉ­λλ” μ»΄ν¬λ„νΈ
regex|`org\.example\.Default.*`|regex ν‘ν„μ‹μ— ν•΄λ‹Ήν•λ” ν΄λμ¤λ…
custom|`org.example.MyTypeFilter`|`org.springframework.core.type.TypeFilter`μ„ κµ¬ν„ν• μ»¤μ¤ν…€ ν•„ν„°

μ•„λ μμ λ” λ¨λ“  `@Repository` μ–΄λ…Έν…μ΄μ…μ„ λ¬΄μ‹ν•κ³  "stub" λ ν¬μ§€ν† λ¦¬λ“¤μ„ λ€μ‹  μ΄μ©ν•λ” μμ μ…λ‹λ‹¤.
```java 
@Configuration
@ComponentScan(basePackages = "org.example",
        includeFilters = @Filter(type = FilterType.REGEX, pattern = ".*Stub.*Repository"),
        excludeFilters = @Filter(Repository.class))
public class AppConfig {
    // ...
}
```

{% hint style="success" %}

#### π’΅ 

μ–΄λ…Έν…μ΄μ…μ `useDefaultFilters=false`λ¥Ό μ΄μ©ν•΄μ„ κΈ°λ³Έ ν•„ν„°λ™μ‘μ„ μ κ±°ν•  μ μμµλ‹λ‹¤. μ΄ κΈ°λ³Έν•„ν„° κΈ°λ¥μ„ μ κ±°ν•λ©΄, `@Component`,`@Repository`,`@Service`,`@Contorller`,`@RestController`,`@Configuration`μ΄ μ‚¬μ©λ ν΄λμ¤λ‚, λ©”νƒ€μ–΄λ…Έν…μ΄μ…λ λ€μƒμ μλ™νƒμ§€λ¥Ό λ°©μ§€ν•©λ‹λ‹¤.

{% endhint %}

### 1.10.5 Defining Bean Metadata within Components

μ¤ν”„λ§ μ»΄ν¬λ„νΈλ“¤μ€ `@Configuration` ν΄λμ¤μ— `@Bean`μ„ μ‚¬μ©ν•¨μΌλ΅μ¨, μ»¨ν…μ΄λ„μ λΉ μ •μ λ©”νƒ€λ°μ΄ν„°λ¥Ό μ¶”κ°€ν•  μ μμµλ‹λ‹¤. μ•„λ μμ λ”, λ©”νƒ€λ°μ΄ν„°λ¥Ό μ¶”κ°€ν•λ” λ°©λ²•μ„ λ³΄μ—¬μ¤λ‹λ‹¤.
```java
@Component
public class FactoryMethodComponent {

    @Bean
    @Qualifier("public")
    public TestBean publicInstance() {
        return new TestBean("publicInstance");
    }

    public void doWork() {
        // Component method implementation omitted
    }
}
```

μ„ μμ μ—μ„ μ¤ν”„λ§ μ»΄ν¬λ„νΈλ” μ–΄ν”λ¦¬μΌ€μ΄μ… λ΅μ§μΈ `doWork()`λ©”μ†λ“λ¥Ό μ§€λ‹κ³  μμ§€λ§, ν•νΈμΌλ΅λ” λΉ μ •μμ— λ©”νƒ€λ°μ΄ν„°λ¥Ό μ¶”κ°€ν•λ” ν©ν† λ¦¬λ©”μ†λ“ `publicInstance()`λ„ μ§€λ‹κ³  μμµλ‹λ‹¤. `@Bean`μ–΄λ…Έν…μ΄μ…μ€ ν©ν† λ¦¬ λ©”μ†λ“μ™€, `@Qualifier`μ–΄λ…Έν…μ΄μ…μ„ ν†µν• qualifierκ°’μ΄λ‚ λ‹¤λ¥Έ λΉ μ •μ μ†μ„±λ“¤μ„ μ‹λ³„ν•©λ‹λ‹¤.(`@Scope`,`@Lazy` νΉμ€ μ»¤μ¤ν…€ qualifier μ–΄λ…Έν…μ΄μ…μ²λΌ λ©”μ†λ“ λ λ²¨μ μ–΄λ…Έν…μ΄μ…)

{% hint style="success" %}

#### π’΅ 

μ»΄ν¬λ„νΈμ μ΄κΈ°ν™” μ—­ν• κ³Ό λ”λ¶μ–΄, `@Lazy` μ–΄λ…Έν…μ΄μ…μ„ `@Autowired`λ‚ `@Inject`κ³Ό ν•¨κ» μ£Όμ…μ§€μ μ— ν•¨κ» μ‚¬μ©ν•  μ μμµλ‹λ‹¤. μ΄ κ²½μ°μ— lazy-resolution ν”„λ΅μ‹λ¥Ό λ€μ‹  μ£Όμ…λ°›κ² λμ§€λ§, ν”„λ΅μ‹ λ°©μ‹μ€ νΉν μ„ νƒμ μΌλ΅ μ£Όμ…λ°›λ” ν™κ²½μ—μ„, μ„Έλ¶€μ μΈ μ„¤μ •μ΄ ν•„μ”ν• μƒν™©μ—μ„ μ ν•μ μ΄κΈ°λ•λ¬Έμ—, `ObjectProvider<MyTargetBean>` λ°©μ‹μ„ μ¶”μ²ν•©λ‹λ‹¤.(μ°Έκ³  : [http://rahulsh1.github.io/tech/2018/12/20/Using-Spring-ObjectProvider](http://rahulsh1.github.io/tech/2018/12/20/Using-Spring-ObjectProvider))

{% endhint %}

ν•„λ“μ™€, λ©”μ†λ“ μ£Όμ…λΏλ§μ•„λ‹λΌ `@Bean` λ©”μ†λ“μ μ£Όμ…λ„ μ§€μ›ν•©λ‹λ‹¤. μ•„λ μμ λ” @Beanλ©”μ†λ“ μ£Όμ… λ‚΄μ©μ…λ‹λ‹¤.

```java
@Component
public class FactoryMethodComponent {

    private static int i;

    @Bean
    @Qualifier("public")
    public TestBean publicInstance() {
        return new TestBean("publicInstance");
    }

    // use of a custom qualifier and autowiring of method parameters
    @Bean
    protected TestBean protectedInstance(
            @Qualifier("public") TestBean spouse,
            @Value("#{privateInstance.age}") String country) {
        TestBean tb = new TestBean("protectedInstance", 1);
        tb.setSpouse(spouse);
        tb.setCountry(country);
        return tb;
    }

    @Bean
    private TestBean privateInstance() {
        return new TestBean("privateInstance", i++);
    }

    @Bean
    @RequestScope
    public TestBean requestScopedInstance() {
        return new TestBean("requestScopedInstance", 3);
    }
}
```

μ„ μ—μ μ—μ„ `String`νƒ€μ… νλΌλ―Έν„° `country`λ” `privateInstance`λΉμ `age`ν”„λ΅νΌν‹°κ°€ μ£Όμ…λ©λ‹λ‹¤. Spring Experssion Languageλ” `#{ expression }` ν•μ‹μΌλ΅ μ°Έμ΅°κ°’μ„ λ‚νƒ€λƒ…λ‹λ‹¤. `@Value` μ–΄λ…Έν…μ΄μ…λ” ν‘ν„μ‹μ„ μ²λ¦¬ν•  λ•, ν•΄λ‹Ή λΉμ μ΅΄μ¬μ—¬λ¶€λ¥Ό μ‚¬μ „μ— μ²΄ν¬ν•κ³  μμµλ‹λ‹¤.

μ¤ν”„λ§ 4.3λ²„μ „λ¶€ν„°, `InjectionPoint`(μ„λΈ ν΄λμ¤: `DependencyDescriptor`) νƒ€μ…μ„ ν©ν† λ¦¬ λ©”μ†λ“ νλΌλ―Έν„°λ΅ νƒ€κ²λΉμ„ μƒλ΅ μƒμ„±λλ” μ£Όμ… μ§€μ μ„ μ°Έμ΅°ν•κΈ°μ„ν•΄μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤. μ΄κ²ƒμ€ μ‹¤μ λ΅ λΉ κ°μ²΄κ°€ μƒμ„±λ  λ•μ—λ§ λ°μƒλκ³ , μ΅΄μ¬ν•λ” λΉ κ°μ²΄μ μ£Όμ…μ κ²½μ°μ—λ” λ°μƒλμ§€ μ•μµλ‹λ‹¤. κ²°κ³Όμ μΌλ΅ μ΄ κΈ°λ¥μ€ λΉμ μ¤μ½”ν”„κ°€ "ν”„λ΅ν† νƒ€μ…"μΌ κ²½μ°μ— μ μ©ν•©λ‹λ‹¤. λ‹¤λ¥Έ μ¤μ½”ν”„μ κ²½μ°μ—, ν•΄λ‹Ή μ¤μ½”ν”„ λ‚΄μ—μ„ μµμ΄λ΅ λΉ κ°μ²΄κ°€ μƒμ„±λλ” μ§€μ μ—μ„λ§ ν™•μΈν•  μ μμµλ‹λ‹¤.( μ: lazy μ‹±κΈ€ν†¤ λΉμ„ μƒμ„±μ”μ²­ν•λ” μ°Έμ΅°μ§€μ ). μ‚¬μ©μλ” μ κ³µλλ” μ£Όμ…μ§€μ μ μ •λ³΄λ¥Ό μ•„λμ™€ κ°™μ΄ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
```java
@Component
public class FactoryMethodComponent {

    @Bean @Scope("prototype")
    public TestBean prototypeInstance(InjectionPoint injectionPoint) {
        return new TestBean("prototypeInstance for " + injectionPoint.getMember());
    }
}
```

μ¤ν”„λ§ μΌλ° μ»΄ν¬λ„νΈμ `@Bean` λ©”μ†λ“λ” `@Configuration` ν΄λμ¤ `@Bean`λ©”μ†λ“μ™€ λ‹¤λ¥΄κ² λ™μ‘ν•©λ‹λ‹¤. μ°¨μ΄μ μ€ `@Component`ν΄λμ¤λ” λ©”μ†λ“λ‚ ν•„λ“μ νΈμ¶μ„ κ°€λ΅μ±„κΈ°μ„ν•΄μ„ CGLIB ν”„λ΅μ‹λ΅ μ²λ¦¬λμ§€ μ•μµλ‹λ‹¤. CGLIB ν”„λ΅μ‹λ” @Configuration ν΄λμ¤μ @Bean λ©”μ„λ“ λ‚΄μ—μ„ λ©”μ„λ“ λλ” ν•„λ“λ¥Ό νΈμ¶ν•μ—¬ κ΄€λ ¨ κ°μ²΄μ— λ€ν• λΉ λ©”νƒ€λ°μ΄ν„° μ°Έμ΅°λ¥Ό λ§λ“λ” λ°©λ²•μ…λ‹λ‹¤. μ΄ λ°©λ²•μ€ μΌλ°μ μΈ μλ°”μ²λΌ νΈμ¶λμ§€ μ•κ³ , `@Bean` λ©”μ†λ“λ¥Ό μ§μ ‘ νΈμ¶ν•΄μ„ λ‹¤λ¥Έ λΉμ„ μ°Έμ΅°ν•  λ•μ—λ„ μ¤ν”„λ§ λΉμ μΌλ°μ μΈ λΌμ΄ν”„μ‚¬μ΄ν΄ κ΄€λ¦¬μ™€ ν”„λ΅μ‹λ¥Ό μ κ³µν•κΈ° μ„ν•΄ μ»¨ν…μ΄λ„λ¥Ό κ±°μΉλ‹¤. λ€μ΅°μ μΌλ΅, `@Component` ν΄λμ¤ λ‚΄ `@Bean` λ©”μ†λ“μ—μ„ λ©”μ†λ“λ‚ ν•„λ“λ¥Ό νΈμ¶ν•λ” κ²ƒμ€ νΉλ³„ν• CGLIB μ²λ¦¬λ‚, λ‹¤λ¥Έ κΈ°λ²•μ΄ μ μ©λμ§€ μ•λ” ν‘μ¤€ μλ°”λ™μ‘ λ°©μ‹μ…λ‹λ‹¤.

{% hint style="success" %}

#### π’΅ 

μ‚¬μ©μλ” `@Bean` λ©”μ†λ“λ¥Ό κµ¬μ„± ν΄λμ¤κ°€ κ°μ²΄λ΅ μƒμ„±λκΈ° μ΄μ „μ— νΈμ¶ κ°€λ¥ν•λ„λ΅, `static`μΌλ΅ μ •μν•  μ λ„ μμµλ‹λ‹¤. μ΄ κΈ°λ²•μ€ post-processorλΉλ“¤(`BeanFactoryPostProcessor`λ‚ `BeanPostProcessor`)λ¥Ό μ •μν•  λ• μ μ©ν•©λ‹λ‹¤. μ™λƒν•λ©΄ μ΄ λΉλ“¤μ€ μ»¨ν…μ΄λ„κ°€ μ΄κΈ°ν™”λ λ• λ‹¤λ¥Έ μ„¤μ • μ»΄ν¬λ„νΈλ“¤μ΄ κµ¬μ„±λκΈ° μ΄μ „μ— μ΄κΈ°ν™”λμ–΄μ•Ό ν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

static `@Bean`λ©”μ†λ“μ κ²½μ°μ— `@Configuarion`ν΄λμ¤ λ©”μ†λ“μΌμ§€λΌλ„ μ»¨ν…μ΄λ„μ— μν•΄ μ²λ¦¬λμ§€ μ•μµλ‹λ‹¤(μ΄μ „ μ„Ήμ…μ—μ„ μ„¤λ…ν–λ“―μ΄). CGLIBλ” ν•μ„ν΄λμ¤κ°€ μ¤μ§ non-static ν•¨μλ§ overrideν•  μ μλ„λ΅ μ ν•ν•κΈ° λ•λ¬Έμ—, λ‹¤λ¥Έ `@Bean`λ©”μ†λ“λ¥Ό μ§μ ‘ νΈμ¶ν•λ”κ²ƒμ€ ν‘μ¤€ μλ°”μ™€ λ™μΌν• μλ―Έλ¥Ό κ°€μ§€λ©°, ν©ν† λ¦¬ λ©”μ†λ“μ—μ„ κ°μ²΄λ¥Ό μ§μ ‘ λ°ν™ν•©λ‹λ‹¤.

`@Bean`λ©”μ†λ“μ μ ‘κ·Ό μ ν•μλ” μ¤ν”„λ§ μ»¨ν…μ΄λ„ λ‚΄ λΉ μ •μμ— μ§μ ‘μ μΈ μν–¥μ€ λΌμΉμ§€ μ•μµλ‹λ‹¤. μ‚¬μ©μλ” ν©ν† λ¦¬ λ©”μ†λ“λ¥Ό μƒν™©μ— λ§λ„λ΅ `@Congiruation` ν΄λμ¤κ°€ μ•„λ‹ μ„μΉλ‚, static μ ν•μλ΅ μμ λ΅­κ² μ •μν•  μ μμµλ‹λ‹¤. ν•μ§€λ§ μΌλ°μ μΌλ΅ `@Configuration`ν΄λμ¤ `@Bean`λ©”μ†λ“λ” overrideκ°€ κ°€λ¥ν•΄μ•Όν•κΈ° λ•λ¬Έμ— `private`μ΄λ‚ `final` μ ν•μλ” μ‚¬μ©ν•μ§€ μ•μµλ‹λ‹¤.

`@Bean`λ©”μ†λ“λ” κΈ°λ³Έ μ»΄ν¬λ„νΈλ‚ κµ¬μ„± ν΄λμ¤μ—μ„ νΈμ¶ν•  μ μμ„ λΏλ§μ•„λ‹λΌ, κµ¬ν„λ java 8 default λ©”μ†λ“λ‚΄μ—μ„λ„ νΈμ¶μ΄ κ°€λ¥ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ λ³µμ΅ν• κµ¬μ„±μ ν™κ²½μ—μ„ λ§μ€ μ μ—°μ„±μ„ ν™•λ³΄ν•  μ μμΌλ©°, μ¤ν”„λ§ 4.2λ¶€ν„° java 8 default λ©”μ†λ“λ¥Ό μ΄μ©ν• λ‹¤μ¤‘μƒμ†λ„ κ°€λ¥ν•©λ‹λ‹¤.

λ§μ§€λ§‰μΌλ΅ λ‹¨μΌ ν΄λμ¤λ” λ°νƒ€μ„μ— μ‚¬μ© κ°€λ¥ν• μΆ…μ†μ„±μ— λ”°λΌ μ‚¬μ©ν•  ν›„λ³΄κµ°λ“¤λ΅μ¨, λ™μΌν• λΉμ— λ€ν• μ—¬λ¬ `@Bean`λ©”μ†λ“λ¥Ό μ§€λ‹ μ μμµλ‹λ‹¤. μ΄ λ°©μ‹μ€ "greediest" μƒμ„±μ νΉμ€ λ‹¤λ¥Έ κµ¬μ„± μ»΄ν¬λ„νΈμ ν©ν† λ¦¬ λ©”μ†λ“λ¥Ό μ„ νƒν•λ” μ•κ³ λ¦¬μ¦κ³Ό λ™μΌν•©λ‹λ‹¤. κ°€μ¥ λ§μ€ μμ΅΄μ„±μ„ λ§μ΅±ν•λ” λ©”μ†λ“κ°€ κ°μ²΄ μƒμ„±μ‹μ μ— μ±„νƒλλ©°, μ»¨ν…μ΄λ„κ°€ λ‹¤μ¤‘ `@Autowired` μƒμ„±μκ°€ μ΅΄μ¬ν•  λ• μ„ νƒν•λ” λ°©μ‹μ…λ‹λ‹¤.

{% endhint %}

## 1.10.6 Naming Autodetected Components

μ¤μΊλ‹ μ‘μ—…μ ν•λ¶€λ¶„μΌλ΅ μ»΄ν¬λ„νΈλ“¤μ΄ μλ™νƒμ§€λ  λ•, μ¤μΊλ„μ `BeanNameGenerator`μ— μν•΄ λΉμ΄λ¦„μ΄ μƒμ„±λ©λ‹λ‹¤. κΈ°λ³Έμ μΌλ΅ `value`μ†μ„±μΌλ΅ μ¤ν…λ μ¤νƒ€μ…(`@Component`, `@Repository`, `@Service`, `@Controller`)μ λΉμ΄λ¦„μ΄ κ²°μ •λ©λ‹λ‹¤.

λ§μ•½μ— `value` κ°’μ΄ μ—†κ±°λ‚, custom ν•„ν„°λ΅ ν›„λ³΄κµ°μΌλ΅ λ“±λ΅λ μ»΄ν¬λ„νΈλ“¤μ κ²½μ°μ—, κΈ°λ³Έ λΉμ΄λ¦„ μƒμ„±μκ°€ μ²«λ¬Έμκ°€ μ†λ¬Έμλ΅ κµ¬μ„±λ non-qualified ν΄λμ¤λ…μΌλ΅ λ°ν™ν•©λ‹λ‹¤. μ•„λ μμ λ” `myMovieLister`μ™€ `movieFinderImpl` μ»΄ν¬λ„νΈμ μμ μ…λ‹λ‹¤.

```java
@Service("myMovieLister")
public class SimpleMovieLister {
    // ...
}
```

```java
@Repository
public class MovieFinderImpl implements MovieFinder {
    // ...
}
```

κΈ°λ³Έ λΉ μ΄λ¦„ μƒμ„±λ°©μ‹μ΄ μ•„λ‹ λ‹¤λ¥Έ λ°©μ‹μ„ μ‚¬μ©ν•  μλ„ μμµλ‹λ‹¤. `BeanNameGenerator` μΈν„°νμ΄μ¤λ¥Ό κΈ°λ³Έ μƒμ„±μκ°€ ν¬ν•¨λλ„λ΅ κµ¬ν„ν• λ’¤, μ¤μΊλ„μ— fully-qualified ν΄λμ¤λ…μ„ μ κ³µν•©λ‹λ‹¤.

{% hint style="success" %}

#### π’΅ 

λΉμ΄λ¦„μ μ¶©λμ΄ λ°μƒν•λ” μΌ€μ΄μ¤λ¥Ό μ„ν•΄μ„(λ‹¤λ¥Έ ν¨ν‚¤μ§€ κ°™μ€ ν΄λμ¤λ…), κΈ°λ³Έμ μΌλ΅ fully-qualified ν΄λμ¤λ…μ„ μ‚¬μ©ν•λ„λ΅ μ²λ¦¬λ¥Ό ν•΄μ¤μ•Όν•©λ‹λ‹¤. μ΄ μ©λ„λ΅ μ‚¬μ©ν•κΈ° μ„ν•΄μ„ μ¤ν”„λ§ 5.2.3 λ¶€ν„°, `org.springframework.context.annotation`μ— μ„μΉν• `FullyQualifiedAnnotationBeanNameGenerator`λ¥Ό μ΄μ©ν•  μ μμµλ‹λ‹¤.
{% endhint %}

```java
@Configuration
@ComponentScan(basePackages = "org.example", nameGenerator = MyNameGenerator.class)
public class AppConfig {
    // ...
}
```

μΌλ°μ μΌλ΅ λ‹¤λ¥Έ μ»΄ν¬λ„νΈκ°€ λ…μ‹μ μΌλ΅ μ»΄ν¬λ„νΈλ¥Ό μ°Έμ΅°ν•  λ•, λΉ μ΄λ¦„μ„ μ§μ ‘ μ§€μ •ν•λ” λ°©μ‹μ„ κ³ λ ¤ν•λ©΄ μΆ‹μµλ‹λ‹¤. λ°λ©΄μ—, μ»¨ν…μ΄λ„μ— μν•΄ μ£Όμ…λλ” μ»΄ν¬λ„νΈμ κ²½μ° μλ™μΌλ΅ μƒμ„±λλ” λΉ μ΄λ¦„μ΄ μ λ‹Ήν•©λ‹λ‹¤.

## 1.10.7 Providing a Scope for Autodeteced Components

μ¤ν”„λ§μ— μν•΄ μλ™νƒμ§€λμ–΄ κ΄€λ¦¬λλ” μ»΄ν¬λ„νΈλ“¤μ€ μΌλ°μ μΌλ΅ `singleton` μ¤μ½”ν”„μ…λ‹λ‹¤. λ•λ•λ΅ μ‹±κΈ€ν†¤ μ΄μ™Έμ μ¤μ½”ν”„λ¥Ό μ§€μ •ν•΄μ•Όν•  κ²½μ° `@Scope`λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
```java
@Scope("prototype")
@Repository
public class MovieFinderImpl implements MovieFinder {
    // ...
}
```

{% hint style="success" %}

#### π’΅ 

`@Scope`λ” κµ¬ν„μ²΄λ‚ ν©ν† λ¦¬ λ©”μ†λ“μ—μ„λ§ μ ν¨ν•©λ‹λ‹¤. XML λΉ μ •μ λ°©μ‹κ³Ό λ‹¤λ¥΄κ², λΉ μ •μ μƒμ†μ κ°λ…μ€ μ—†μΌλ©°, ν΄λμ¤ λ λ²¨μ μƒμ†κ³„μΈµμ€ λ©”νƒ€λ°μ΄ν„°μ™€ κ΄€λ ¨μ΄ μ—†μµλ‹λ‹¤.
{% endhint %}

μ¤ν”„λ§ μ»¨ν…μ¤νΈ λ‚΄ "request" νΉμ€ "session" μ›Ή ν•μ • μ¤μ½”ν”„κ°€ μ΅΄μ¬ν•λ” κ²ƒμ²λΌ, μ‚¬μ©μλ„ μμ‹ λ§μ μ¤μ½”ν”„λ¥Ό λ©”νƒ€ μ–΄λ…Έν…μ΄μ… λ°©μ‹μ„ μ΄μ©ν•΄μ„ λ§λ“¤ μ μμµλ‹λ‹¤. μλ¥Όλ“¤λ©΄ `@Scope("prototype")`μ„ λ©”νƒ€μ–΄λ…Έν…μ΄μ…μΌλ΅ μƒλ΅μ΄ μ¤μ½”ν”„ μ–΄λ…Έν…μ΄μ…μ„ λ§λ“¤ μ μμµλ‹λ‹¤.

{% hint style="success" %}

#### π’΅ 

μ–΄λ…Έν…μ΄μ… λ°©μ‹μ΄ μ•„λ‹, μ‚¬μ©μ μ •μ μ¤μ½”ν”„ λ°©μ‹μ„ μ΄μ©ν•κΈ° μ„ν•΄μ„ `ScopeMetadataResolver` μΈν„°νμ΄μ¤λ¥Ό κΈ°λ³Έ μƒμ„±μκ°€ ν¬ν•¨λ κ°μ²΄λ΅ κµ¬ν„ν•΄ μ‚¬μ©ν•  μ μμµλ‹λ‹¤. μ•„λλ” μ¤μΊλ„λ¥Ό μ„¤μ •ν•λ” λ°©λ²•μ…λ‹λ‹¤.
```java
@Configuration
@ComponentScan(basePackages = "org.example", scopeResolver = MyScopeResolver.class)
public class AppConfig {
    // ...
}
```
{% endhint %}

λ§μ•½ non-singleton μ¤μ½”ν”„λ¥Ό μ‚¬μ©ν•λ‹¤λ©΄, μ¤μ½”ν”„ μ ν•λ ν”„λ΅μ‹ κ°μ²΄λ¥Ό μƒμ„±ν•΄μ•Όλ§ ν•©λ‹λ‹¤. κ·Έ μ΄μ λ” [Scoped Beans as Dependencies](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-scopes-other-injection)λ¥Ό μ°Έκ³ ν•μ„Έμ”. μ΄ λ• `@ComponentScan`μ scoped-proxy μ†μ„±κ°’μ„ μ΄μ©ν•  μ μμµλ‹λ‹¤. scoped-proxyμ κ°€λ¥ν• κ°’μ€ 3κ°€μ§€(no,interfaces,targetClass) μ΄λ©°, μ•„λ μμ λ” ν‘μ¤€ JDK λ™μ  ν”„λ΅μ‹ μμ μ…λ‹λ‹¤. 
```java
@Configuration
@ComponentScan(basePackages = "org.example", scopedProxy = ScopedProxyMode.INTERFACES)
public class AppConfig {
    // ...
}
```

## 1.10.8 Providing Qualifier Metadata with Annotations


[Fine-tuning Annotation-based Autowiring with Qualifiers](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-autowired-annotation-qualifiers)μ—μ„ autowire ν›„λ³΄ μ»΄ν¬λ„νΈλ“¤ μ‚¬μ΄μ— μ£Όμ…λ  μ μ ν• μ»΄ν¬λ„νΈλ¥Ό μ •ν•  λ•, `@Qualifier`μ–΄λ…Έν…μ΄μ…μ΄λ‚ custom `@Qualifier`μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν• μμ λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. μ΄ μμ λ“¤μ€ λ¨λ‘ xml λΉμ •μ λ°©μ‹ κΈ°λ°μ΄μ—κΈ° λ•λ¬Έμ—, qualifier λ©”νƒ€λ°μ΄ν„°κ°€ `qualifier`λ‚ `meta`μ΄ `bean`μ μμ‹κ°μ²΄λ΅ μ κ³µλμ—μµλ‹λ‹¤. ν΄λμ¤ν¨μ¤ μ¤μΊλ‹μ„ ν†µν• μ»΄ν¬λ„νΈμ μλ™νƒμ§€λ¥Ό μ΄μ©ν• λ•μ—λ” `@Qualifier`μ–΄λ…Έν…μ΄μ…μ„ ν΄λμ¤μ— μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

```java
@Component
@Qualifier("Action")
public class ActionMovieCatalog implements MovieCatalog {
    // ...
}

```

```java
@Component
@Genre("Action")
public class ActionMovieCatalog implements MovieCatalog {
    // ...
}
```

```java
@Component
@Offline
public class CachingMovieCatalog implements MovieCatalog {
    // ...
}
```

{% hint style="success" %}

#### π’΅ 

μ–΄λ…Έν…μ΄μ… κΈ°λ°μΌλ΅ λ€μ²΄ν•  λ•, μ–΄λ…Έν…μ΄μ… λ°©μ‹μ€ ν΄λμ¤μ— λ©”νƒ€λ°μ΄ν„°κ°€ λ°”μΈλ”©λμ§€λ§, xml λ°©μ‹μ€ λ©”νƒ€λ°μ΄ν„°λ¥Ό κ°μ²΄κΈ°λ°μΌλ΅ λ°”μΈλ”©ν•κΈ° λ•λ¬Έμ—, λ™μΌ νƒ€μ…λ‚΄ μ—¬λ¬ λΉλ“¤μ— λ‹¤μ–‘ν• qualifier λ©”νƒ€λ°μ΄ν„°λ¥Ό μ κ³µν•  μ μμµλ‹λ‹¤.
```xml
    <bean class="example.SimpleMovieCatalog">
        <qualifier value="main"/> 

        <!-- inject any dependencies required by this bean -->
    </bean>

    <bean class="example.SimpleMovieCatalog">
        <qualifier value="action"/> 

        <!-- inject any dependencies required by this bean -->
    </bean>
```

{% endhint %}

## 1.10.9 Generating an Index of Candidate Components

ν΄λμ¤ν¨μ¤ μ¤μΊλ‹μ„ λΉ λ¥΄μ§€λ§, μ»΄νμΌ νƒ€μ„μ— μ •μ  μ»΄ν¬λ„νΈ λ¦¬μ¤νΈλ¥Ό λ§λ“¤μ–΄ λ‘ μΌλ΅μ¨, κ·λ¨κ°€ ν° μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ κµ¬λ™ν•  λ•, μ„±λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μμµλ‹λ‹¤. μ΄ λ¨λ“μ—μ„λ” λ¨λ“  μ»΄ν¬λ„νΈλ“¤μ΄ λ™μΌν• λ°©μ‹μΌλ΅ μ²λ¦¬λ©λ‹λ‹¤.

{% hint style="success" %}

#### π’΅ 

νΉμ • ν¨ν‚¤μ§€ λ‚΄ μ»΄ν¬λ„νΈλ“¤μ„ κ²€μƒ‰ν•λ„λ΅ μ”μ²­ν•κΈ° μ„ν•΄μ„λ”, `@ComponentScan`μ„ λ³€κ²½ν•μ§€ μ•κ³  μ μ§€ν•΄μ•Όν•©λ‹λ‹¤. `ApplicationContext`κ°€ indexλ¥Ό λ°κ²¬ν–μ„ λ•, ν΄λμ¤ κ²½λ΅λ¥Ό κ²€μƒ‰ν•λ” λ€μ‹  μλ™μΌλ΅ μΈλ±μ¤λ¥Ό μ‚¬μ©ν•κΈ° λ•λ¬Έμ…λ‹λ‹¤. 

{% endhint %}

indexλ¥Ό μƒμ„±ν•κΈ° μ„ν•΄μ„, μ–΄ν”λ¦¬μΌ€μ΄μ… μ»΄ν¬λ„νΈλ“¤μ΄ ν¬ν•¨λ κ° λ¨λ“μ€ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ¶”κ°€ν•΄μ•Όν•©λ‹λ‹¤. μ•„λλ” maven μμ μ…λ‹λ‹¤.
```xml
<dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context-indexer</artifactId>
        <version>5.3.21</version>
        <optional>true</optional>
    </dependency>
</dependencies>
```

gradle 4.5 μ΄μ „λ²„μ „μ—μ„λ” `compileOnly`λ¥Ό μ΄μ©ν•΄μ•Όλ§ ν•©λ‹λ‹¤.

```groovy
dependencies {
    compileOnly "org.springframework:spring-context-indexer:5.3.21"
}
```

gralde 4.6 μ΄ν›„λ¶€ν„°λ”, λΌμ΄λΈλ¬λ¦¬λ¥Ό `annotationProcessor`λ¥Ό μ΄μ©ν•΄μ•Ό ν•©λ‹λ‹¤.
```groovy
dependencies {
    annotationProcessor "org.springframework:spring-context-indexer:5.3.21"
}
```

`spring-context-indexer`λ” `META-INF/spring.components`νμΌμ„ jarλ‚΄μ— μƒμ„±ν•©λ‹λ‹¤.

{% hint style="success" %}

#### π’΅ 

IDEμ—μ„ indexerλ¥Ό μ‚¬μ©ν•  λ•, μ»΄ν¬λ„νΈλ“¤μ΄ μμ •λ λ•λ§λ‹¤, indexλ¥Ό μµμ‹ μΌλ΅ μ μ§€ν•κΈ° μ„ν•΄μ„ indexerλ” μ–΄λ…Έν…μ΄μ… ν”„λ΅μ„Έμ„λ΅ λ“±λ΅λμ–΄μ•Ό ν•λ‹¤.
{% endhint %}

{% hint style="success" %}

#### π’΅ 

`META-INF/spring.components` νμΌμ΄ ν΄λμ¤ν¨μ¤λ‚΄ μ΅΄μ¬ν•λ‹¤λ©΄, μΈλ±μ¤κ°€ μ‚¬μ©λ©λ‹λ‹¤. μΌλ¶€ λΌμ΄λΈλ¬λ¦¬μ— μΈλ±μ¤λ¥Ό λ¶€λ¶„μ μΌλ΅ μ‚¬μ©ν•  μ μμ§€λ§, μ „μ²΄ ν”„λ΅κ·Έλ¨μ„ λΉλ“ν•  μ μ—†λ” κ²½μ° JVM μ‹μ¤ν… μ†μ„± νΉμ€ [SpringProperties](https://docs.spring.io/spring-framework/docs/current/reference/html/appendix.html#appendix-spring-properties)μ„ ν†µν•΄ spring.index.ignoreλ¥Ό trueλ΅ μ„¤μ •ν•΄μ„ μΌλ° ν΄λμ¤ κ²½λ΅λ¥Ό μ¤μΊ”ν•λ„λ΅ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.(μΈλ±μ¤κ°€ μ—†λ”κ²ƒ μ²λΌ)
{% endhint %}